<?xml version="1.0"?>
<!-- CPSA 4.4.2 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Session Binding Protocol with mTLS 1.3/client's perspective analysis (uses the modified server as implemented and tested in the paper and the cookie authentication model (ca.scm) which showed the cookie stealing attack).</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald
  &quot;Session Binding Protocol with mTLS 1.3/client&apos;s perspective analysis (uses the modified server as implemented and tested in the paper and the cookie authentication model (ca.scm) which showed the cookie stealing attack).&quot;
  (bound 12) (limit 2000))
(comment &quot;CPSA 4.4.2&quot;)
(comment &quot;All input read from mtls13_sbp.scm&quot;)
(comment &quot;Strand count bounded at 12&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t15">15</a> <a href="#t78">78</a>.</p>

<p id="t0">Tree <a href="#top">0</a>, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='429.360pt' height='304.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 429.360 304.920' font-size='12.000'>
  <text
   x='389.400' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k14&quot;, &quot;_self&quot;)'>14</text>
  <line
   x1='339.480' y1='227.460' x2='389.400' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k13&quot;, &quot;_self&quot;)'>13</text>
  <line
   x1='339.480' y1='227.460' x2='389.400' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='289.560' y1='227.460' x2='339.480' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='239.640' y1='227.460' x2='289.560' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='189.720' y1='227.460' x2='239.640' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='139.800' y1='152.460' x2='189.720' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k12&quot;, &quot;_self&quot;)'>12</text>
  <line
   x1='339.480' y1='77.460' x2='389.400' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k11&quot;, &quot;_self&quot;)'>11</text>
  <line
   x1='339.480' y1='77.460' x2='389.400' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k9&quot;, &quot;_self&quot;)'>9</text>
  <line
   x1='289.560' y1='77.460' x2='339.480' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='239.640' y1='77.460' x2='289.560' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='189.720' y1='77.460' x2='239.640' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='139.800' y1='152.460' x2='189.720' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='89.880' y1='152.460' x2='139.800' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='152.460' x2='89.880' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (p password) (cookie any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole clientr
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x)
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (p password) (cookie data) (ppk skey) (any mesg)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (cookie data) (ppk skey) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    (non-orig ppk)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defrule clients-servers-distinct1
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p &quot;clienta&quot; &quot;c&quot; z c) (p &quot;clienta&quot; &quot;s&quot; z-0 c))
        (false))))
  (defrule clients-servers-distinct2
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p &quot;clienta&quot; &quot;c&quot; z c) (p &quot;clientr&quot; &quot;s&quot; z-0 c))
        (false))))
  (defrule clients-servers-distinct3
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p &quot;clientr&quot; &quot;c&quot; z c) (p &quot;clientr&quot; &quot;s&quot; z-0 c))
        (false))))
  (defrule clients-servers-distinct4
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p &quot;clientr&quot; &quot;c&quot; z c) (p &quot;clienta&quot; &quot;s&quot; z-0 c))
        (false))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 4)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 5)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 4)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 5)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 0</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x)
  (goals
    (forall
      ((cookie data) (p password) (cr sr random32) (spk cpk akey)
        (c u s ca name) (x rndx) (y expt) (z z-0 strd))
      (implies
        (and (p &quot;clienta&quot; z 9) (p &quot;&quot; z-0 2)
          (p &quot;clienta&quot; &quot;cookie&quot; z cookie) (p &quot;clienta&quot; &quot;p&quot; z p)
          (p &quot;clienta&quot; &quot;cr&quot; z cr) (p &quot;clienta&quot; &quot;sr&quot; z sr)
          (p &quot;clienta&quot; &quot;spk&quot; z spk) (p &quot;clienta&quot; &quot;cpk&quot; z cpk)
          (p &quot;clienta&quot; &quot;c&quot; z c) (p &quot;clienta&quot; &quot;u&quot; z u)
          (p &quot;clienta&quot; &quot;s&quot; z s) (p &quot;clienta&quot; &quot;ca&quot; z ca)
          (p &quot;clienta&quot; &quot;y&quot; z y) (p &quot;&quot; &quot;x&quot; z-0 cookie)
          (p &quot;clienta&quot; &quot;x&quot; z x) (non (invk spk)) (non (invk cpk))
          (non (privk ca)) (pnon p) (uniq sr) (ugen x) (uniq-at cr z 0))
        (false))))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 0)
  (unrealized (1 1))
  (origs (pt-0 (1 6)) (cr (1 0)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>, Child: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 1</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x)
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 1)
  (parent 0)
  (unrealized (1 1))
  (origs (pt-0 (1 6)) (cr (1 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k3">3</a> <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 2</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt)
    (y-0 rndx) (x-0 expt))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((2 1) (1 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr-0
              sr-0))))))
  (label 2)
  (parent 1)
  (unrealized (1 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k2">2</a>, Child: <a href="#k5">5</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 3</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 2 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))))
  (label 3)
  (parent 2)
  (unrealized (1 4) (1 8))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k4">Item <a href="#t0">4</a>, Parent: <a href="#k2">2</a>, Child: <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 4</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))))
  (label 4)
  (parent 2)
  (unrealized (1 4) (1 8))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k5">Item <a href="#t0">5</a>, Parent: <a href="#k3">3</a>, Child: <a href="#k7">7</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 242.280 300.660 144.719 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 5</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (3 0)) ((3 1) (1 4)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (enc &quot;login-successful&quot; cookie
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (1 4))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 5)
  (parent 3)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k6">Item <a href="#t0">6</a>, Parent: <a href="#k4">4</a>, Child: <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 292.543 301.118 145.286 412.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 386.820 189.960 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 6</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 1) (4 0))
    ((4 1) (1 4)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (enc &quot;login-successful&quot; cookie
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (1 4))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 6)
  (parent 4)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t0">7</a>, Parent: <a href="#k5">5</a>, Child: <a href="#k9">9</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 242.689 338.906 145.538 412.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 7</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (4 0)) ((3 1) (1 4))
    ((4 1) (3 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))
    (3 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 7)
  (parent 5)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k8">Item <a href="#t0">8</a>, Parent: <a href="#k6">6</a>, Child: <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 292.770 339.232 145.741 413.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 436.800 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 8</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 1) (5 0))
    ((4 1) (1 4)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 8)
  (parent 6)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k9">Item <a href="#t0">9</a>, Parent: <a href="#k7">7</a>, Children: <a href="#k11">11</a> <a href="#k12">12</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 242.880 377.460 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 9</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (5 0)) ((3 1) (1 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
    (hash (exp (gen) (mul x y)) &quot;derived&quot;) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;))))
  (label 9)
  (parent 7)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k10">Item <a href="#t0">10</a>, Parent: <a href="#k8">8</a>, Children: <a href="#k13">13</a> <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 292.860 377.460 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.880 152.460 145.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 486.780 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 10</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 1) (6 0))
    ((4 1) (1 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
    (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
  (label 10)
  (parent 8)
  (unrealized (6 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k11">Item <a href="#t0">11</a>, Parent: <a href="#k9">9</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.300 225.660 144.719 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 11</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (6 0)) ((3 1) (1 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 11)
  (parent 9)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k12">Item <a href="#t0">12</a>, Parent: <a href="#k9">9</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 242.880 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.300 225.660 144.719 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 186.900 114.960 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 12</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk cpk akey) (c u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)) ((2 1) (6 0)) ((3 1) (1 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 12)
  (parent 9)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k13">Item <a href="#t0">13</a>, Parent: <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 292.860 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.689 188.906 145.538 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 536.760 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.300 225.660 144.719 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='389.820' y='39.960' style='text-anchor: middle;'>ca 13</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 1) (7 0))
    ((4 1) (1 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 13)
  (parent 10)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k14">Item <a href="#t0">14</a>, Parent: <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 292.860 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 242.689 188.906 145.538 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 536.760 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 192.300 225.660 144.719 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc cookie request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; cookie (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 236.880 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g><title>cookie</title><circle cx='39.960' cy='189.960' r='6.000'/>
   </g>
  <g><title>cookie</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie cookie) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='389.820' y='39.960' style='text-anchor: middle;'>ca 14</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (deflistener cookie)
  (defstrand clienta 9 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)) ((3 1) (7 0))
    ((4 1) (1 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (invk cpk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 14)
  (parent 10)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t15">Tree <a href="#top">15</a>, POV <a href="#k15">15</a>.</p>

<div>
 <svg
  class='diagram' width='629.040pt' height='1654.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 629.040 1654.920' font-size='12.000'>
  <text
   x='389.400' y='1601.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k51&quot;, &quot;_self&quot;)'>51</text>
  <line
   x1='339.480' y1='1577.460' x2='389.400' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1526.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k50&quot;, &quot;_self&quot;)'>50</text>
  <line
   x1='339.480' y1='1577.460' x2='389.400' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1563.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k37&quot;, &quot;_self&quot;)'>37</text>
  <line
   x1='289.560' y1='1577.460' x2='339.480' y2='1577.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1563.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k29&quot;, &quot;_self&quot;)'>29</text>
  <line
   x1='239.640' y1='1577.460' x2='289.560' y2='1577.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='1563.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k23&quot;, &quot;_self&quot;)'>23</text>
  <line
   x1='189.720' y1='1239.960' x2='239.640' y2='1577.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1451.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k49&quot;, &quot;_self&quot;)'>49</text>
  <line
   x1='339.480' y1='1427.460' x2='389.400' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1376.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k48&quot;, &quot;_self&quot;)'>48</text>
  <line
   x1='339.480' y1='1427.460' x2='389.400' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1413.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k36&quot;, &quot;_self&quot;)'>36</text>
  <line
   x1='289.560' y1='1427.460' x2='339.480' y2='1427.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1413.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k28&quot;, &quot;_self&quot;)'>28</text>
  <line
   x1='239.640' y1='1164.960' x2='289.560' y2='1427.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1301.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k67&quot;, &quot;_self&quot;)'>67</text>
  <line
   x1='439.320' y1='1277.460' x2='489.240' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1226.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k66&quot;, &quot;_self&quot;)'>66</text>
  <line
   x1='439.320' y1='1277.460' x2='489.240' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1263.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k59&quot;, &quot;_self&quot;)'>59</text>
  <line
   x1='389.400' y1='1277.460' x2='439.320' y2='1277.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1263.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k47&quot;, &quot;_self&quot;)'>47</text>
  <line
   x1='339.480' y1='1277.460' x2='389.400' y2='1277.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1263.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k35&quot;, &quot;_self&quot;)'>35</text>
  <line
   x1='289.560' y1='1089.960' x2='339.480' y2='1277.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1151.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k73&quot;, &quot;_self&quot;)'>73</text>
  <line
   x1='489.240' y1='1127.460' x2='539.160' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1076.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k72&quot;, &quot;_self&quot;)'>72</text>
  <line
   x1='489.240' y1='1127.460' x2='539.160' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1113.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k65&quot;, &quot;_self&quot;)'>65</text>
  <line
   x1='439.320' y1='1127.460' x2='489.240' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1113.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k58&quot;, &quot;_self&quot;)'>58</text>
  <line
   x1='389.400' y1='1127.460' x2='439.320' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1113.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k46&quot;, &quot;_self&quot;)'>46</text>
  <line
   x1='339.480' y1='1014.960' x2='389.400' y2='1127.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1001.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k77&quot;, &quot;_self&quot;)'>77</text>
  <line
   x1='539.160' y1='977.460' x2='589.080' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k76&quot;, &quot;_self&quot;)'>76</text>
  <line
   x1='539.160' y1='977.460' x2='589.080' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k71&quot;, &quot;_self&quot;)'>71</text>
  <line
   x1='489.240' y1='977.460' x2='539.160' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k64&quot;, &quot;_self&quot;)'>64</text>
  <line
   x1='439.320' y1='977.460' x2='489.240' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k57&quot;, &quot;_self&quot;)'>57</text>
  <line
   x1='389.400' y1='939.960' x2='439.320' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='851.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k52&quot;, &quot;_self&quot;)'>52</text>
  <line
   x1='439.320' y1='864.960' x2='489.240' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='851.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k56&quot;, &quot;_self&quot;)'>56</text>
  <line
   x1='389.400' y1='939.960' x2='439.320' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='926.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k45&quot;, &quot;_self&quot;)'>45</text>
  <line
   x1='339.480' y1='1014.960' x2='389.400' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1001.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k34&quot;, &quot;_self&quot;)'>34</text>
  <line
   x1='289.560' y1='1089.960' x2='339.480' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1076.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k27&quot;, &quot;_self&quot;)'>27</text>
  <line
   x1='239.640' y1='1164.960' x2='289.560' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='1151.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='189.720' y1='1239.960' x2='239.640' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='1226.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k19&quot;, &quot;_self&quot;)'>19</text>
  <line
   x1='139.800' y1='827.460' x2='189.720' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k44&quot;, &quot;_self&quot;)'>44</text>
  <line
   x1='339.480' y1='752.460' x2='389.400' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k43&quot;, &quot;_self&quot;)'>43</text>
  <line
   x1='339.480' y1='752.460' x2='389.400' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k33&quot;, &quot;_self&quot;)'>33</text>
  <line
   x1='289.560' y1='752.460' x2='339.480' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k26&quot;, &quot;_self&quot;)'>26</text>
  <line
   x1='239.640' y1='752.460' x2='289.560' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='738.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k21&quot;, &quot;_self&quot;)'>21</text>
  <line
   x1='189.720' y1='414.960' x2='239.640' y2='752.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k42&quot;, &quot;_self&quot;)'>42</text>
  <line
   x1='339.480' y1='602.460' x2='389.400' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k41&quot;, &quot;_self&quot;)'>41</text>
  <line
   x1='339.480' y1='602.460' x2='389.400' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k32&quot;, &quot;_self&quot;)'>32</text>
  <line
   x1='289.560' y1='602.460' x2='339.480' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k25&quot;, &quot;_self&quot;)'>25</text>
  <line
   x1='239.640' y1='339.960' x2='289.560' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k63&quot;, &quot;_self&quot;)'>63</text>
  <line
   x1='439.320' y1='452.460' x2='489.240' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k62&quot;, &quot;_self&quot;)'>62</text>
  <line
   x1='439.320' y1='452.460' x2='489.240' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k55&quot;, &quot;_self&quot;)'>55</text>
  <line
   x1='389.400' y1='452.460' x2='439.320' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k40&quot;, &quot;_self&quot;)'>40</text>
  <line
   x1='339.480' y1='452.460' x2='389.400' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k31&quot;, &quot;_self&quot;)'>31</text>
  <line
   x1='289.560' y1='264.960' x2='339.480' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k70&quot;, &quot;_self&quot;)'>70</text>
  <line
   x1='489.240' y1='302.460' x2='539.160' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k69&quot;, &quot;_self&quot;)'>69</text>
  <line
   x1='489.240' y1='302.460' x2='539.160' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k61&quot;, &quot;_self&quot;)'>61</text>
  <line
   x1='439.320' y1='302.460' x2='489.240' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k54&quot;, &quot;_self&quot;)'>54</text>
  <line
   x1='389.400' y1='302.460' x2='439.320' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k39&quot;, &quot;_self&quot;)'>39</text>
  <line
   x1='339.480' y1='189.960' x2='389.400' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k75&quot;, &quot;_self&quot;)'>75</text>
  <line
   x1='539.160' y1='152.460' x2='589.080' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k74&quot;, &quot;_self&quot;)'>74</text>
  <line
   x1='539.160' y1='152.460' x2='589.080' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k68&quot;, &quot;_self&quot;)'>68</text>
  <line
   x1='489.240' y1='152.460' x2='539.160' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k60&quot;, &quot;_self&quot;)'>60</text>
  <line
   x1='439.320' y1='152.460' x2='489.240' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k53&quot;, &quot;_self&quot;)'>53</text>
  <line
   x1='389.400' y1='114.960' x2='439.320' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k52&quot;, &quot;_self&quot;)'>52</text>
  <line
   x1='389.400' y1='114.960' x2='439.320' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k38&quot;, &quot;_self&quot;)'>38</text>
  <line
   x1='339.480' y1='189.960' x2='389.400' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k30&quot;, &quot;_self&quot;)'>30</text>
  <line
   x1='289.560' y1='264.960' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k24&quot;, &quot;_self&quot;)'>24</text>
  <line
   x1='239.640' y1='339.960' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='326.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='189.720' y1='414.960' x2='239.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k18&quot;, &quot;_self&quot;)'>18</text>
  <line
   x1='139.800' y1='827.460' x2='189.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='813.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k17&quot;, &quot;_self&quot;)'>17</text>
  <line
   x1='89.880' y1='827.460' x2='139.800' y2='827.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='813.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k16&quot;, &quot;_self&quot;)'>16</text>
  <line
   x1='39.960' y1='827.460' x2='89.880' y2='827.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='813.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k15&quot;, &quot;_self&quot;)'>15</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (p password) (cookie any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole clientr
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x)
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (p password) (cookie data) (ppk skey) (any mesg)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (cookie data) (ppk skey) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    (non-orig ppk)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defrule clients-servers-distinct1
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p &quot;clienta&quot; &quot;c&quot; z c) (p &quot;clienta&quot; &quot;s&quot; z-0 c))
        (false))))
  (defrule clients-servers-distinct2
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p &quot;clienta&quot; &quot;c&quot; z c) (p &quot;clientr&quot; &quot;s&quot; z-0 c))
        (false))))
  (defrule clients-servers-distinct3
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p &quot;clientr&quot; &quot;c&quot; z c) (p &quot;clientr&quot; &quot;s&quot; z-0 c))
        (false))))
  (defrule clients-servers-distinct4
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p &quot;clientr&quot; &quot;c&quot; z c) (p &quot;clienta&quot; &quot;s&quot; z-0 c))
        (false))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 4)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 5)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 4)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 5)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))</pre>

<p id="k15">Item <a href="#t15">15</a>, Child: <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 15</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (goals
    (forall
      ((z strd) (cookie data) (c u s ca name) (spk cpk akey)
        (cr sr random32) (ppk skey) (x rndx) (y expt))
      (implies
        (and (p &quot;clienta&quot; z 9)
          (p &quot;clienta&quot; &quot;cookie&quot; z
            (enc cookie
              (hash ppk (hash (exp (exp (gen) y) x) &quot;derived&quot;))))
          (p &quot;clienta&quot; &quot;c&quot; z c) (p &quot;clienta&quot; &quot;u&quot; z u)
          (p &quot;clienta&quot; &quot;s&quot; z s) (p &quot;clienta&quot; &quot;spk&quot; z spk)
          (p &quot;clienta&quot; &quot;cpk&quot; z cpk) (p &quot;clienta&quot; &quot;ca&quot; z ca)
          (p &quot;clienta&quot; &quot;cr&quot; z cr) (p &quot;clienta&quot; &quot;sr&quot; z sr)
          (p &quot;clienta&quot; &quot;x&quot; z x) (p &quot;clienta&quot; &quot;y&quot; z y) (non (privk ca))
          (non (invk cpk)) (non (invk spk)) (non ppk) (uniq sr)
          (uniq-at cr z 0) (ugen-at x z 0))
        (exists ((z0 strd))
          (and (p &quot;servera&quot; z0 9) (p &quot;servera&quot; &quot;cookie&quot; z0 cookie)
            (p &quot;servera&quot; &quot;u&quot; z0 u) (p &quot;servera&quot; &quot;s&quot; z0 s)
            (uniq-at cookie z0 4) (fact neq u s))))))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 15)
  (unrealized (0 1) (0 4))
  (origs (pt-0 (0 6)) (cr (0 0)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k16">Item <a href="#t15">16</a>, Parent: <a href="#k15">15</a>, Child: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 16</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 16)
  (parent 15)
  (unrealized (0 1) (0 4))
  (origs (pt-0 (0 6)) (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k17">Item <a href="#t15">17</a>, Parent: <a href="#k16">16</a>, Children: <a href="#k18">18</a> <a href="#k19">19</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 17</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt)
    (y-0 rndx) (x-0 expt))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr-0
              sr-0))))))
  (label 17)
  (parent 16)
  (unrealized (0 1) (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k18">Item <a href="#t15">18</a>, Parent: <a href="#k17">17</a>, Children: <a href="#k20">20</a> <a href="#k21">21</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 18</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))))
  (label 18)
  (parent 17)
  (unrealized (0 4) (0 8))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k19">Item <a href="#t15">19</a>, Parent: <a href="#k17">17</a>, Children: <a href="#k22">22</a> <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 19</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (added-strand serverr 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))))
  (label 19)
  (parent 17)
  (unrealized (0 4) (0 8))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k20">Item <a href="#t15">20</a>, Parent: <a href="#k18">18</a>, Children: <a href="#k24">24</a> <a href="#k25">25</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 20</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (cpk spk cpk-0 akey)
    (c u c-0 u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 4) (0 4)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 1 2 servera 5)
    (enc &quot;login-successful&quot;
      (enc cookie (hash ppk (hash (exp (gen) (mul x y-0)) &quot;derived&quot;)))
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y-0)) &quot;derived&quot;))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 20)
  (parent 18)
  (unrealized (0 8) (1 2) (1 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k21">Item <a href="#t15">21</a>, Parent: <a href="#k18">18</a>, Child: <a href="#k26">26</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 142.320 300.660 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 21</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 4)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (enc &quot;login-successful&quot;
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 21)
  (parent 18)
  (unrealized (0 4) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k22">Item <a href="#t15">22</a>, Parent: <a href="#k19">19</a>, Children: <a href="#k27">27</a> <a href="#k28">28</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 22</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 akey) (c u c-0 u-0 s ca name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 4) (0 4)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 3 servera 5)
    (enc &quot;login-successful&quot;
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-1)) &quot;derived&quot;)))
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-1)) &quot;derived&quot;))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 22)
  (parent 19)
  (unrealized (0 8) (2 2) (2 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k23">Item <a href="#t15">23</a>, Parent: <a href="#k19">19</a>, Child: <a href="#k29">29</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 192.583 301.118 45.326 412.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 23</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 4)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (enc &quot;login-successful&quot;
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (0 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 23)
  (parent 19)
  (unrealized (0 4) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k24">Item <a href="#t15">24</a>, Parent: <a href="#k20">20</a>, Children: <a href="#k30">30</a> <a href="#k31">31</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 24</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (cpk spk akey)
    (c u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 4) (0 4)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 0 clientr 3)
    (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
              (enc (hash s spk) (privk ca))) (invk spk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
            (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0
          (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk
              (enc (hash s spk) (privk ca))) (invk spk)))
        (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
            cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
      (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 24)
  (parent 20)
  (unrealized (0 8) (1 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k25">Item <a href="#t15">25</a>, Parent: <a href="#k20">20</a>, Child: <a href="#k32">32</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 25</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (cpk spk cpk-0 akey)
    (c u c-0 u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 4) (0 4))
    ((2 1) (1 2)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
              (enc (hash s spk) (privk ca))) (invk spk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
            (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0
          (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk
              (enc (hash s spk) (privk ca))) (invk spk)))
        (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
            cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
      (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))))
  (label 25)
  (parent 20)
  (unrealized (0 8) (1 2) (1 3) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k26">Item <a href="#t15">26</a>, Parent: <a href="#k21">21</a>, Child: <a href="#k33">33</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 26</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 4))
    ((3 1) (2 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 26)
  (parent 21)
  (unrealized (0 4) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k27">Item <a href="#t15">27</a>, Parent: <a href="#k22">22</a>, Children: <a href="#k34">34</a> <a href="#k35">35</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 27</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk akey) (c u u-0 s ca name) (pt pt-0 pval) (cookiestor locn)
    (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 4) (0 4)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 0 clientr 3)
    (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
      (enc
        (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
              spk (enc (hash s spk) (privk ca))) (invk spk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
            (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
          cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s
              spk (enc (hash s spk) (privk ca))) (invk spk)))
        (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
            cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 27)
  (parent 22)
  (unrealized (0 8) (2 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k28">Item <a href="#t15">28</a>, Parent: <a href="#k22">22</a>, Child: <a href="#k36">36</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 28</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 akey) (c u c-0 u-0 s ca name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 4) (0 4)) ((3 1) (2 2)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
      (enc
        (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
              spk (enc (hash s spk) (privk ca))) (invk spk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
            (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
          cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat s spk (enc (hash s spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
            (enc (hash s spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
          (cat s spk (enc (hash s spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s
              spk (enc (hash s spk) (privk ca))) (invk spk)))
        (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
            cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))))
  (label 28)
  (parent 22)
  (unrealized (0 8) (2 2) (2 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k29">Item <a href="#t15">29</a>, Parent: <a href="#k23">23</a>, Child: <a href="#k37">37</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.810 339.232 45.781 413.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 29</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 4)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 29)
  (parent 23)
  (unrealized (0 4) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k30">Item <a href="#t15">30</a>, Parent: <a href="#k24">24</a>, Children: <a href="#k38">38</a> <a href="#k39">39</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 30</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (cpk spk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 4) (0 4)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 0 clienta 4)
    (enc &quot;login&quot; u-0 p-0
      (hash &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y)) &quot;derived&quot;))) (1 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))))
  (label 30)
  (parent 24)
  (unrealized (0 8))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k31">Item <a href="#t15">31</a>, Parent: <a href="#k24">24</a>, Child: <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.300 300.660 144.719 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 31</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (cpk spk akey)
    (c u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (2 0))
    ((1 4) (0 4)) ((2 1) (1 3)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (enc &quot;login&quot; u-0 p-0
      (hash &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (1 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 31)
  (parent 24)
  (unrealized (0 8) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k32">Item <a href="#t15">32</a>, Parent: <a href="#k25">25</a>, Children: <a href="#k41">41</a> <a href="#k42">42</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 32</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (cpk spk cpk-0 akey)
    (c u c-0 u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 4) (0 4))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))))
  (label 32)
  (parent 25)
  (unrealized (1 2) (3 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k33">Item <a href="#t15">33</a>, Parent: <a href="#k26">26</a>, Children: <a href="#k43">43</a> <a href="#k44">44</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 33</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
    (hash (exp (gen) (mul x y)) &quot;derived&quot;) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;))))
  (label 33)
  (parent 26)
  (unrealized (0 4) (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k34">Item <a href="#t15">34</a>, Parent: <a href="#k27">27</a>, Children: <a href="#k45">45</a> <a href="#k46">46</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 34</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (cpk spk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 4) (0 4)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 0 clienta 4)
    (enc &quot;login&quot; u-0 p-0
      (hash &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-1 y-0)) &quot;derived&quot;))) (2 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))))
  (label 34)
  (parent 27)
  (unrealized (0 8))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k35">Item <a href="#t15">35</a>, Parent: <a href="#k27">27</a>, Child: <a href="#k47">47</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.260 300.660 244.679 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 35</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk akey) (c u u-0 s ca name) (pt pt-0 pval) (cookiestor locn)
    (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (3 0)) ((2 4) (0 4)) ((3 1) (2 3)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (enc &quot;login&quot; u-0 p-0
      (hash &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (2 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 35)
  (parent 27)
  (unrealized (0 8) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k36">Item <a href="#t15">36</a>, Parent: <a href="#k28">28</a>, Children: <a href="#k48">48</a> <a href="#k49">49</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 36</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 akey) (c u c-0 u-0 s ca name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 4) (0 4)) ((3 1) (2 2)) ((4 1) (3 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))))
  (label 36)
  (parent 28)
  (unrealized (2 2) (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k37">Item <a href="#t15">37</a>, Parent: <a href="#k29">29</a>, Children: <a href="#k50">50</a> <a href="#k51">51</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 37</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 4)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
    (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
  (label 37)
  (parent 29)
  (unrealized (0 4) (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k38">Item <a href="#t15">38</a>, Parent: <a href="#k30">30</a>, Children: <a href="#k52">52</a> <a href="#k53">53</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 38</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 4) (0 4)) ((1 8) (0 8)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 1 2 servera 9)
    (enc response
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul y-0 x)) &quot;derived&quot;))) (0 8))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 38)
  (parent 30)
  (unrealized (1 7))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k39">Item <a href="#t15">39</a>, Parent: <a href="#k30">30</a>, Child: <a href="#k54">54</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 141.138 449.718 42.396 709.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 39</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (cpk spk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (2 0)) ((1 4) (0 4)) ((2 1) (0 8)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
    (enc response
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (0 8))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
  (label 39)
  (parent 30)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k40">Item <a href="#t15">40</a>, Parent: <a href="#k31">31</a>, Child: <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 40</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (cpk spk akey)
    (c u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (3 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 40)
  (parent 31)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k41">Item <a href="#t15">41</a>, Parent: <a href="#k32">32</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 41</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (cpk spk cpk-0 akey)
    (c u c-0 u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 4) (0 4))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 41)
  (parent 32)
  (unrealized (1 2) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k42">Item <a href="#t15">42</a>, Parent: <a href="#k32">32</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 42</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (cpk spk cpk-0 akey)
    (c u c-0 u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 4) (0 4))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 42)
  (parent 32)
  (unrealized (1 2) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k43">Item <a href="#t15">43</a>, Parent: <a href="#k33">33</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 43</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 43)
  (parent 33)
  (unrealized (0 4) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k44">Item <a href="#t15">44</a>, Parent: <a href="#k33">33</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 44</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 4))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 44)
  (parent 33)
  (unrealized (0 4) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k45">Item <a href="#t15">45</a>, Parent: <a href="#k34">34</a>, Children: <a href="#k56">56</a> <a href="#k57">57</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 45</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 4) (0 4)) ((2 8) (0 8)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 3 servera 9)
    (enc response
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul y-1 x-0)) &quot;derived&quot;))) (0 8))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 45)
  (parent 34)
  (unrealized (2 7))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k46">Item <a href="#t15">46</a>, Parent: <a href="#k34">34</a>, Child: <a href="#k58">58</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 191.564 449.964 43.287 709.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 46</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (cpk spk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (3 0)) ((2 4) (0 4)) ((3 1) (0 8)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
    (enc response
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (0 8))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
  (label 46)
  (parent 34)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k47">Item <a href="#t15">47</a>, Parent: <a href="#k35">35</a>, Child: <a href="#k59">59</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 47</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk akey) (c u u-0 s ca name) (pt pt-0 pval) (cookiestor locn)
    (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (4 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (hash &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 47)
  (parent 35)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k48">Item <a href="#t15">48</a>, Parent: <a href="#k36">36</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 48</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 akey) (c u c-0 u-0 s ca name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 4) (0 4)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 48)
  (parent 36)
  (unrealized (2 2) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k49">Item <a href="#t15">49</a>, Parent: <a href="#k36">36</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 49</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 akey) (c u c-0 u-0 s ca name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk-0) (c c-0) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 4) (0 4)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 49)
  (parent 36)
  (unrealized (2 2) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k50">Item <a href="#t15">50</a>, Parent: <a href="#k37">37</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 50</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 4)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 50)
  (parent 37)
  (unrealized (0 4) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k51">Item <a href="#t15">51</a>, Parent: <a href="#k37">37</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 51</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk cpk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 4)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 51)
  (parent 37)
  (unrealized (0 4) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k52">Item <a href="#t15">52</a>, Parent: <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 52</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (ppk skey)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((0 7) (1 7))
    ((1 1) (0 1)) ((1 4) (0 4)) ((1 8) (0 8)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 2 0 clienta 8)
    (enc
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) &quot;derived&quot;)))
      request-0
      (hash &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y)) &quot;derived&quot;))) (1 7))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))))
  (label 52)
  (parent 38)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cookie cookie) (c c) (u u) (s s) (ca ca) (spk spk) (cpk cpk)
        (cr cr) (sr sr) (ppk ppk) (x x) (y y) (p p) (any any)
        (cookiestor cookiestor) (request request) (response response))))
  (origs (pt-0 (0 6)) (cookie (1 4)) (pt-2 (1 6)) (sr (1 1))
    (cr (0 0))))</pre>

<p id="k53">Item <a href="#t15">53</a>, Parent: <a href="#k38">38</a>, Child: <a href="#k60">60</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 190.673 449.561 141.465 634.162'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 53</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (2 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      request-0
      (hash &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (1 7))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 53)
  (parent 38)
  (unrealized (1 7) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k54">Item <a href="#t15">54</a>, Parent: <a href="#k39">39</a>, Child: <a href="#k61">61</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 141.331 487.313 42.783 709.665'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 54</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (cpk spk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (3 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
  (label 54)
  (parent 39)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k55">Item <a href="#t15">55</a>, Parent: <a href="#k40">40</a>, Children: <a href="#k62">62</a> <a href="#k63">63</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 55</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (cpk spk akey)
    (c u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (4 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
    (hash (exp (gen) (mul x y)) &quot;derived&quot;) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;))))
  (label 55)
  (parent 40)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k56">Item <a href="#t15">56</a>, Parent: <a href="#k45">45</a>, Seen Child: <a href="#k52">52</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 56</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((0 7) (2 7))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 4) (0 4)) ((2 8) (0 8)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test (displaced 3 0 clienta 8)
    (enc
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) &quot;derived&quot;)))
      request-0
      (hash &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-1 y-0)) &quot;derived&quot;))) (2 7))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))))
  (label 56)
  (parent 45)
  (seen 52)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k57">Item <a href="#t15">57</a>, Parent: <a href="#k45">45</a>, Child: <a href="#k64">64</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 290.633 449.561 241.425 634.162'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 57</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (3 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (hash &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (enc
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      request-0
      (hash &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (2 7))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 57)
  (parent 45)
  (unrealized (2 7) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k58">Item <a href="#t15">58</a>, Parent: <a href="#k46">46</a>, Child: <a href="#k65">65</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 191.774 487.617 43.707 710.274'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 58</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (cpk spk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (4 0)) ((2 4) (0 4)) ((3 1) (0 8))
    ((4 1) (3 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
  (label 58)
  (parent 46)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k59">Item <a href="#t15">59</a>, Parent: <a href="#k47">47</a>, Children: <a href="#k66">66</a> <a href="#k67">67</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 59</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk akey) (c u u-0 s ca name) (pt pt-0 pval) (cookiestor locn)
    (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (5 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
    (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
  (label 59)
  (parent 47)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k60">Item <a href="#t15">60</a>, Parent: <a href="#k53">53</a>, Child: <a href="#k68">68</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 190.848 487.114 141.817 634.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 60</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (3 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 60)
  (parent 53)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k61">Item <a href="#t15">61</a>, Parent: <a href="#k54">54</a>, Children: <a href="#k69">69</a> <a href="#k70">70</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 141.584 524.964 43.287 709.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 61</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (cpk spk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul y x)) &quot;derived&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (4 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) &quot;derived&quot;))
    (hash (exp (gen) (mul y x)) &quot;derived&quot;) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul y x)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul y x)) &quot;derived&quot;))))
  (label 61)
  (parent 54)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k62">Item <a href="#t15">62</a>, Parent: <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 62</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (cpk spk akey)
    (c u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (5 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 62)
  (parent 55)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k63">Item <a href="#t15">63</a>, Parent: <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 63</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (cpk spk akey)
    (c u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 1) (5 0))
    ((1 4) (0 4)) ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 63)
  (parent 55)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k64">Item <a href="#t15">64</a>, Parent: <a href="#k57">57</a>, Child: <a href="#k71">71</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 290.808 487.114 241.777 634.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 64</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (4 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener
      (cat &quot;c ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (hash &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 64)
  (parent 57)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k65">Item <a href="#t15">65</a>, Parent: <a href="#k58">58</a>, Children: <a href="#k72">72</a> <a href="#k73">73</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.021 525.338 44.202 710.717'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 65</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (cpk spk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (5 0)) ((2 4) (0 4)) ((3 1) (0 8))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))
    (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
  (label 65)
  (parent 58)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k66">Item <a href="#t15">66</a>, Parent: <a href="#k59">59</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 66</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk akey) (c u u-0 s ca name) (pt pt-0 pval) (cookiestor locn)
    (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 66)
  (parent 59)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k67">Item <a href="#t15">67</a>, Parent: <a href="#k59">59</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 67</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk akey) (c u u-0 s ca name) (pt pt-0 pval) (cookiestor locn)
    (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u-0) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 67)
  (parent 59)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k68">Item <a href="#t15">68</a>, Parent: <a href="#k60">60</a>, Children: <a href="#k74">74</a> <a href="#k75">75</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 191.118 524.718 142.356 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 68</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (4 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
    (hash (exp (gen) (mul x y)) &quot;derived&quot;) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;))))
  (label 68)
  (parent 60)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k69">Item <a href="#t15">69</a>, Parent: <a href="#k61">61</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 141.913 562.717 43.945 710.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 69</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (cpk spk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul y x)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul y x)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul y x)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 69)
  (parent 61)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k70">Item <a href="#t15">70</a>, Parent: <a href="#k61">61</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y x)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y x)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 141.913 562.717 43.945 710.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 70</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (cpk spk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y) (x x))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul y x)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((2 1) (0 8)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul y x)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul y x)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 70)
  (parent 61)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k71">Item <a href="#t15">71</a>, Parent: <a href="#k64">64</a>, Children: <a href="#k76">76</a> <a href="#k77">77</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 291.078 524.718 242.316 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 71</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (5 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
    (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
  (label 71)
  (parent 64)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k72">Item <a href="#t15">72</a>, Parent: <a href="#k65">65</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.300 563.160 44.759 711.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 72</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (cpk spk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (6 0)) ((2 4) (0 4)) ((3 1) (0 8))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 72)
  (parent 65)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k73">Item <a href="#t15">73</a>, Parent: <a href="#k65">65</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.300 563.160 44.759 711.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 73</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (cpk spk akey)
    (c u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 5 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (y y-0) (x x-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (6 0)) ((2 4) (0 4)) ((3 1) (0 8))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk cpk) (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 73)
  (parent 65)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k74">Item <a href="#t15">74</a>, Parent: <a href="#k68">68</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 191.564 562.464 143.247 634.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 74</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 74)
  (parent 68)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k75">Item <a href="#t15">75</a>, Parent: <a href="#k68">68</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 191.564 562.464 143.247 634.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 75</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y) (x x))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 3) (1 3)) ((1 1) (0 1))
    ((1 1) (5 0)) ((1 4) (0 4)) ((1 8) (0 8)) ((2 1) (1 7))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 75)
  (parent 68)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k76">Item <a href="#t15">76</a>, Parent: <a href="#k71">71</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 291.524 562.464 243.207 634.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 76</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (6 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 76)
  (parent 71)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k77">Item <a href="#t15">77</a>, Parent: <a href="#k71">71</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 291.524 562.464 243.207 634.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request-0 (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg authstor (cat pt-2 &quot;server store&quot; s u cookie))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg authstor (cat pt-1 any-0))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt-0 &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt any))</title>
   <circle style='fill: gray;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((any any-0) (cookie cookie) (response response) (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (response response) (request request) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <text x='339.840' y='39.960' style='text-anchor: middle;'>ca 77</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk cpk akey) (c u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clienta 9
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand servera 9 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (authstor authstor) (y y-0)
    (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 3) (2 3)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 1) (6 0)) ((2 4) (0 4)) ((2 8) (0 8))
    ((3 1) (2 7)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6
    trRl_servera-at-5 trRl_servera-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request-0
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 77)
  (parent 71)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t78">Tree <a href="#top">78</a>, POV <a href="#k78">78</a>.</p>

<div>
 <svg
  class='diagram' width='579.120pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.120 754.920' font-size='12.000'>
  <text
   x='289.560' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k88&quot;, &quot;_self&quot;)'>88</text>
  <line
   x1='239.640' y1='564.960' x2='289.560' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k102&quot;, &quot;_self&quot;)'>102</text>
  <line
   x1='389.400' y1='602.460' x2='439.320' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k101&quot;, &quot;_self&quot;)'>101</text>
  <line
   x1='389.400' y1='602.460' x2='439.320' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k96&quot;, &quot;_self&quot;)'>96</text>
  <line
   x1='339.480' y1='602.460' x2='389.400' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='588.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k92&quot;, &quot;_self&quot;)'>92</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='602.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k108&quot;, &quot;_self&quot;)'>108</text>
  <line
   x1='489.240' y1='452.460' x2='539.160' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k107&quot;, &quot;_self&quot;)'>107</text>
  <line
   x1='489.240' y1='452.460' x2='539.160' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k104&quot;, &quot;_self&quot;)'>104</text>
  <line
   x1='439.320' y1='452.460' x2='489.240' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k100&quot;, &quot;_self&quot;)'>100</text>
  <line
   x1='389.400' y1='452.460' x2='439.320' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k95&quot;, &quot;_self&quot;)'>95</text>
  <line
   x1='339.480' y1='452.460' x2='389.400' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='438.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k91&quot;, &quot;_self&quot;)'>91</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='452.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k87&quot;, &quot;_self&quot;)'>87</text>
  <line
   x1='239.640' y1='564.960' x2='289.560' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k84&quot;, &quot;_self&quot;)'>84</text>
  <line
   x1='189.720' y1='564.960' x2='239.640' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k82&quot;, &quot;_self&quot;)'>82</text>
  <line
   x1='139.800' y1='377.460' x2='189.720' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k86&quot;, &quot;_self&quot;)'>86</text>
  <line
   x1='239.640' y1='189.960' x2='289.560' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k99&quot;, &quot;_self&quot;)'>99</text>
  <line
   x1='389.400' y1='227.460' x2='439.320' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k98&quot;, &quot;_self&quot;)'>98</text>
  <line
   x1='389.400' y1='227.460' x2='439.320' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k94&quot;, &quot;_self&quot;)'>94</text>
  <line
   x1='339.480' y1='227.460' x2='389.400' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='213.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k90&quot;, &quot;_self&quot;)'>90</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k106&quot;, &quot;_self&quot;)'>106</text>
  <line
   x1='489.240' y1='77.460' x2='539.160' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='26.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k105&quot;, &quot;_self&quot;)'>105</text>
  <line
   x1='489.240' y1='77.460' x2='539.160' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k103&quot;, &quot;_self&quot;)'>103</text>
  <line
   x1='439.320' y1='77.460' x2='489.240' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k97&quot;, &quot;_self&quot;)'>97</text>
  <line
   x1='389.400' y1='77.460' x2='439.320' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k93&quot;, &quot;_self&quot;)'>93</text>
  <line
   x1='339.480' y1='77.460' x2='389.400' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='63.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k89&quot;, &quot;_self&quot;)'>89</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k85&quot;, &quot;_self&quot;)'>85</text>
  <line
   x1='239.640' y1='189.960' x2='289.560' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k83&quot;, &quot;_self&quot;)'>83</text>
  <line
   x1='189.720' y1='189.960' x2='239.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k81&quot;, &quot;_self&quot;)'>81</text>
  <line
   x1='139.800' y1='377.460' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k80&quot;, &quot;_self&quot;)'>80</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k79&quot;, &quot;_self&quot;)'>79</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='363.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k78&quot;, &quot;_self&quot;)'>78</text>
  </svg></div>

<pre>(defprotocol ca basic
  (defrole clienta
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (p password) (cookie any mesg) (cookiestor locn)
      (request httpreq) (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot; cookie
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor any)
      (stor cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole clientr
    (vars (c u s ca name) (cr sr random32) (x rndx) (y expt)
      (spk cpk akey) (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (load cookiestor (cat &quot;client store&quot; u s cookie))
      (send
        (enc cookie request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x)
    (gen-st (cat &quot;client store&quot; u s cookie)))
  (defrole servera
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (p password) (cookie data) (ppk skey) (any mesg)
      (authstor locn) (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load authstor any)
      (stor authstor (cat &quot;server store&quot; s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s)))
  (defrole serverr
    (vars (c u s ca name) (cr sr random32) (y rndx) (x expt)
      (spk cpk akey) (cookie data) (ppk skey) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (load authstor (cat &quot;server store&quot; s u cookie))
      (send
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    (non-orig ppk)
    (uniq-gen y)
    (absent (y x))
    (facts (neq u s))
    (gen-st (cat &quot;server store&quot; s u cookie)))
  (defrule clients-servers-distinct1
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p &quot;clienta&quot; &quot;c&quot; z c) (p &quot;clienta&quot; &quot;s&quot; z-0 c))
        (false))))
  (defrule clients-servers-distinct2
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p &quot;clienta&quot; &quot;c&quot; z c) (p &quot;clientr&quot; &quot;s&quot; z-0 c))
        (false))))
  (defrule clients-servers-distinct3
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p &quot;clientr&quot; &quot;c&quot; z c) (p &quot;clientr&quot; &quot;s&quot; z-0 c))
        (false))))
  (defrule clients-servers-distinct4
    (forall ((z z-0 strd) (c name))
      (implies
        (and (p &quot;clientr&quot; &quot;c&quot; z c) (p &quot;clienta&quot; &quot;s&quot; z-0 c))
        (false))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;servera&quot; z (idx 4)) (p &quot;servera&quot; &quot;s&quot; z s)
          (p &quot;servera&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p &quot;serverr&quot; z (idx 5)) (p &quot;serverr&quot; &quot;s&quot; z s)
          (p &quot;serverr&quot; &quot;u&quot; z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_clienta-at-5
    (forall ((z strd))
      (implies (p &quot;clienta&quot; z (idx 7)) (trans z (idx 5)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 7)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-5
    (forall ((z strd))
      (implies (p &quot;servera&quot; z (idx 7)) (trans z (idx 5)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p &quot;clientr&quot; z (idx 4)) (p &quot;clientr&quot; &quot;cookie&quot; z cookie)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;u&quot; z u))
        (gen-st (cat &quot;client store&quot; u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p &quot;serverr&quot; z (idx 5)) (p &quot;serverr&quot; &quot;cookie&quot; z cookie)
          (p &quot;serverr&quot; &quot;u&quot; z u) (p &quot;serverr&quot; &quot;s&quot; z s))
        (gen-st (cat &quot;server store&quot; s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))</pre>

<p id="k78">Item <a href="#t78">78</a>, Child: <a href="#k79">79</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='339.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 78</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk cpk akey) (c u s ca name) (pt pval)
    (cookiestor locn) (x rndx) (y expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (goals
    (forall
      ((z strd) (cookie data) (c u s ca name) (cr sr random32) (x rndx)
        (y expt) (spk cpk akey) (ppk skey))
      (implies
        (and (p &quot;clientr&quot; z 6)
          (p &quot;clientr&quot; &quot;cookie&quot; z
            (enc cookie
              (hash ppk (hash (exp (exp (gen) y) x) &quot;derived&quot;))))
          (p &quot;clientr&quot; &quot;c&quot; z c) (p &quot;clientr&quot; &quot;u&quot; z u)
          (p &quot;clientr&quot; &quot;s&quot; z s) (p &quot;clientr&quot; &quot;spk&quot; z spk)
          (p &quot;clientr&quot; &quot;cpk&quot; z cpk) (p &quot;clientr&quot; &quot;ca&quot; z ca)
          (p &quot;clientr&quot; &quot;cr&quot; z cr) (p &quot;clientr&quot; &quot;sr&quot; z sr)
          (p &quot;clientr&quot; &quot;x&quot; z x) (p &quot;clientr&quot; &quot;y&quot; z y) (non (privk ca))
          (non (invk cpk)) (non (invk spk)) (non ppk) (uniq sr)
          (uniq-at cr z 0) (ugen-at x z 0))
        (exists ((z0 strd))
          (and (p &quot;servera&quot; z0 7) (p &quot;servera&quot; &quot;cookie&quot; z0 cookie)
            (p &quot;servera&quot; &quot;u&quot; z0 u) (p &quot;servera&quot; &quot;s&quot; z0 s)
            (uniq-at cookie z0 4) (fact neq u s))))))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 78)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (comment &quot;Not closed under rules&quot;))</pre>

<p id="k79">Item <a href="#t78">79</a>, Parent: <a href="#k78">78</a>, Child: <a href="#k80">80</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='339.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='39.960' y='39.960' style='text-anchor: middle;'>ca 79</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk cpk akey) (c u s ca name) (pt pval)
    (cookiestor locn) (x rndx) (y expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (rule gen-st-clientr-0)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 79)
  (parent 78)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k80">Item <a href="#t78">80</a>, Parent: <a href="#k79">79</a>, Children: <a href="#k81">81</a> <a href="#k82">82</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='339.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 80</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk cpk akey) (c u s ca name)
    (pt pval) (cookiestor locn) (x rndx) (y expt) (y-0 rndx) (x-0 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (y y-0) (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr-0
              sr-0))))))
  (label 80)
  (parent 79)
  (unrealized (0 1) (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k81">Item <a href="#t78">81</a>, Parent: <a href="#k80">80</a>, Child: <a href="#k83">83</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='339.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='89.940' y='39.960' style='text-anchor: middle;'>ca 81</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk cpk akey) (c u s ca name) (pt pval)
    (cookiestor locn) (x y rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))))
  (label 81)
  (parent 80)
  (unrealized (0 3) (0 5))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k82">Item <a href="#t78">82</a>, Parent: <a href="#k80">80</a>, Child: <a href="#k84">84</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: orange;' cx='39.960' cy='339.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 82</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk cpk akey) (c u s ca name)
    (pt pval) (cookiestor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (operation encryption-test (added-strand serverr 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk
        (enc (hash s spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))))
  (label 82)
  (parent 80)
  (unrealized (0 3) (0 5))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k83">Item <a href="#t78">83</a>, Parent: <a href="#k81">81</a>, Children: <a href="#k85">85</a> <a href="#k86">86</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.158 299.718 42.396 409.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 188.682 299.718 237.444 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 83</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk cpk spk-0 cpk-0 akey) (c u s ca c-0 ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y x-0 rndx) (y-0 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 4)) ((2 6) (0 3)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (leads-to ((2 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation channel-test (added-strand clienta 7)
    (ch-msg cookiestor
      (cat pt &quot;client store&quot; u s
        (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))))
  (label 83)
  (parent 81)
  (unrealized (0 5) (2 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k84">Item <a href="#t78">84</a>, Parent: <a href="#k82">82</a>, Children: <a href="#k87">87</a> <a href="#k88">88</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 141.913 262.717 43.945 410.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 288.642 299.718 337.404 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.158 299.718 42.396 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 84</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk cpk spk-0 cpk-0 akey) (c u s ca c-0 ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 4))
    ((3 6) (0 3)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (leads-to ((3 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation channel-test (added-strand clienta 7)
    (ch-msg cookiestor
      (cat pt &quot;client store&quot; u s
        (enc cookie
          (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))))
  (label 84)
  (parent 82)
  (unrealized (0 5) (3 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k85">Item <a href="#t78">85</a>, Parent: <a href="#k83">83</a>, Children: <a href="#k89">89</a> <a href="#k90">90</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 141.913 262.717 43.945 410.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-0) (sr sr-0) (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 85</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 cpk-1 akey) (c u c-0 ca c-1 u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u)
    (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0)
    (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 4) (1 4)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 1 3 servera 5)
    (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-1)) &quot;derived&quot;)))
    (2 4))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (recv
        (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (invk cpk-1))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
              (invk cpk-1)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 85)
  (parent 83)
  (unrealized (0 5) (1 4) (2 2) (2 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k86">Item <a href="#t78">86</a>, Parent: <a href="#k83">83</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 291.524 337.464 243.207 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.158 299.718 42.396 409.477'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 86</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk cpk spk-0 cpk-0 akey) (c u s ca c-0 ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y x-0 rndx) (y-0 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x)
    (y y))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))
  (deflistener (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 6) (0 3))
    ((3 1) (2 4)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (leads-to ((2 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (2 4))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c
              cpk (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c cpk (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
    ((recv (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send (hash ppk (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 86)
  (parent 83)
  (unrealized (0 5) (3 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k87">Item <a href="#t78">87</a>, Parent: <a href="#k84">84</a>, Children: <a href="#k91">91</a> <a href="#k92">92</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.300 263.160 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.158 299.718 42.396 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (response response) (request request) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 87</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 cpk-1 akey) (c u c-0 ca c-1 u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx)
    (y-0 expt) (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0)
    (y y-1) (x x-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 4) (2 4)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 2 4 servera 5)
    (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-2)) &quot;derived&quot;)))
    (3 4))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (recv
        (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (invk cpk-1))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
              (invk cpk-1)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
  (label 87)
  (parent 84)
  (unrealized (0 5) (2 4) (3 2) (3 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k88">Item <a href="#t78">88</a>, Parent: <a href="#k84">84</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 391.484 337.464 343.167 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 192.900 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='339.840' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0))) (invk cpk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 141.913 262.717 43.945 410.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.158 299.718 42.396 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c cpk (enc (hash c cpk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c cpk (enc (hash c cpk) (privk ca))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr) (sr sr) (spk spk) (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 88</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk cpk spk-0 cpk-0 akey) (c u s ca c-0 ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (cpk cpk) (c c) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0)
    (y y-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (y y-0)
    (x x-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))
  (deflistener (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 6) (0 3)) ((4 1) (3 4)))
  (non-orig ppk (invk spk) (invk cpk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (leads-to ((3 6) (0 3)))
  (rule trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (3 4))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y-0))
                    (cat sr (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c cpk
              (enc (hash c cpk) (privk ca))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y-0)) (cat sr (exp (gen) x-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c cpk (enc (hash c cpk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x-0))
                    (cat sr (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr
                      sr)) (cat cr (exp (gen) y-0))
                  (cat sr (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y-0))
                      (cat sr (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c cpk
                (enc (hash c cpk) (privk ca))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) s
                spk (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  s spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca-0)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
    ((recv (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 88)
  (parent 84)
  (unrealized (0 5) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k89">Item <a href="#t78">89</a>, Parent: <a href="#k85">85</a>, Child: <a href="#k93">93</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-0) (sr sr-0) (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='139.920' y='39.960' style='text-anchor: middle;'>ca 89</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 akey) (c u c-0 ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u)
    (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0)
    (y y-0) (x x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 4) (1 4)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 3 0 clientr 3)
    (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
      (enc
        (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1
          cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
        (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))
          (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0))
              s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
        (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
        (enc
          (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1
            cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)))
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (2 2))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 89)
  (parent 85)
  (unrealized (0 5) (1 4) (2 3))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k90">Item <a href="#t78">90</a>, Parent: <a href="#k85">85</a>, Child: <a href="#k94">94</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 141.913 262.717 43.945 410.475'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-0) (sr sr-0) (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 90</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 cpk-1 akey) (c u c-0 ca c-1 u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u)
    (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0)
    (y y-0) (x x-0))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 4) (1 4)) ((3 1) (2 2)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
    (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
      (enc
        (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1
          cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
        (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))
          (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0))
              s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
        (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
        (enc
          (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1
            cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)))
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (2 2))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (recv
        (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (invk cpk-1))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
              (invk cpk-1)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))))
  (label 90)
  (parent 85)
  (unrealized (0 5) (1 4) (2 2) (2 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k91">Item <a href="#t78">91</a>, Parent: <a href="#k87">87</a>, Child: <a href="#k95">95</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (response response) (request request) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 91</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 akey) (c u c-0 ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx)
    (y-0 expt) (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0)
    (y y-1) (x x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 4) (2 4)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test (displaced 4 0 clientr 3)
    (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
      (enc
        (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1
          cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
        (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))
          (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1))
              s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
        (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
        (enc
          (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1
            cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)))
      (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (3 2))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
  (label 91)
  (parent 87)
  (unrealized (0 5) (2 4) (3 3))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k92">Item <a href="#t78">92</a>, Parent: <a href="#k87">87</a>, Child: <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.300 263.160 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 386.820 189.960 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.158 299.718 42.396 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (response response) (request request) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 92</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 cpk-1 akey) (c u c-0 ca c-1 u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx)
    (y-0 expt) (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0)
    (y y-1) (x x-1))
  (deflistener
    (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (4 0)) ((3 4) (2 4)) ((4 1) (3 2)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
    (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
      (enc
        (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1
          cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
        (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
        (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
        (enc
          (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s
            spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))
          (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1))
          (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1))
              s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
        (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
        (enc
          (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1
            cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)))
      (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (3 2))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (recv
        (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (invk cpk-1))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
              (invk cpk-1)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
      (send (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))))
  (label 92)
  (parent 87)
  (unrealized (0 5) (2 4) (3 2) (3 3) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k93">Item <a href="#t78">93</a>, Parent: <a href="#k89">89</a>, Child: <a href="#k97">97</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.260 300.660 244.679 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-0) (sr sr-0) (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='189.900' y='39.960' style='text-anchor: middle;'>ca 93</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 akey) (c u c-0 ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u)
    (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0)
    (y y-0) (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr-0 sr-0
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (3 0)) ((2 4) (1 4)) ((3 1) (2 3)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash &quot;c ap traffic&quot; cr-0 sr-0
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (enc &quot;login&quot; u-0 p-0
      (hash &quot;c ap traffic&quot; cr-0 sr-0
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (2 3))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr-0 sr-0
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr-0 sr-0
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 93)
  (parent 89)
  (unrealized (0 5) (1 4) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k94">Item <a href="#t78">94</a>, Parent: <a href="#k90">90</a>, Children: <a href="#k98">98</a> <a href="#k99">99</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 141.584 299.964 43.287 484.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-0) (sr sr-0) (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 94</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 cpk-1 akey) (c u c-0 ca c-1 u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u)
    (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0)
    (y y-0) (x x-0))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 4) (1 4)) ((3 1) (2 2)) ((4 1) (3 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0) (3 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (recv
        (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (invk cpk-1))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
              (invk cpk-1)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))))
  (label 94)
  (parent 90)
  (unrealized (2 2) (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k95">Item <a href="#t78">95</a>, Parent: <a href="#k91">91</a>, Child: <a href="#k100">100</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.220 300.660 344.639 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 386.820 189.960 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (response response) (request request) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 95</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 akey) (c u c-0 ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx)
    (y-0 expt) (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0)
    (y y-1) (x x-1))
  (deflistener
    (hash &quot;c ap traffic&quot; cr-1 sr-1
      (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (4 0)) ((3 4) (2 4)) ((4 1) (3 3)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (hash &quot;c ap traffic&quot; cr-1 sr-1
        (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
    (enc &quot;login&quot; u-0 p-0
      (hash &quot;c ap traffic&quot; cr-1 sr-1
        (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (3 3))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr-1 sr-1
         (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr-1 sr-1
          (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (label 95)
  (parent 91)
  (unrealized (0 5) (2 4) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k96">Item <a href="#t78">96</a>, Parent: <a href="#k92">92</a>, Children: <a href="#k101">101</a> <a href="#k102">102</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.021 300.338 44.202 485.716'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 436.800 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 90.888 337.114 41.857 484.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (response response) (request request) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 96</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 cpk-1 akey) (c u c-0 ca c-1 u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx)
    (y-0 expt) (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0)
    (y y-1) (x x-1))
  (deflistener
    (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (5 0)) ((3 4) (2 4)) ((4 1) (3 2)) ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
    (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1) (4 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (recv
        (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (invk cpk-1))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
              (invk cpk-1)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
      (send (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
      (send (cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))))
  (label 96)
  (parent 92)
  (unrealized (3 2) (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k97">Item <a href="#t78">97</a>, Parent: <a href="#k93">93</a>, Child: <a href="#k103">103</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-0) (sr sr-0) (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='239.880' y='39.960' style='text-anchor: middle;'>ca 97</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 akey) (c u c-0 ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u)
    (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0)
    (y y-0) (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr-0 sr-0
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr-0 sr-0
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (4 0)) ((2 4) (1 4)) ((3 1) (2 3)) ((4 1) (3 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat &quot;c ap traffic&quot; cr-0 sr-0
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (hash &quot;c ap traffic&quot; cr-0 sr-0
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)) (3 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr-0 sr-0
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr-0 sr-0
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr-0 sr-0
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr-0 sr-0
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 97)
  (parent 93)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k98">Item <a href="#t78">98</a>, Parent: <a href="#k94">94</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 141.331 337.313 42.783 559.665'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-0) (sr sr-0) (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 98</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 cpk-1 akey) (c u c-0 ca c-1 u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u)
    (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0)
    (y y-0) (x x-0))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 4) (1 4)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (recv
        (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (invk cpk-1))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
              (invk cpk-1)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 98)
  (parent 94)
  (unrealized (2 2) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k99">Item <a href="#t78">99</a>, Parent: <a href="#k94">94</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 141.331 337.313 42.783 559.665'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-0) (sr sr-0) (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text x='289.860' y='39.960' style='text-anchor: middle;'>ca 99</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 cpk-1 akey) (c u c-0 ca c-1 u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u)
    (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0)
    (y y-0) (x x-0))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 6) (0 3)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 4) (1 4)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (recv
        (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (invk cpk-1))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
              (invk cpk-1)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 99)
  (parent 94)
  (unrealized (2 2) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k100">Item <a href="#t78">100</a>, Parent: <a href="#k95">95</a>, Child: <a href="#k104">104</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.900 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 436.800 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 186.900 227.460 333.840 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (response response) (request request) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 100</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 akey) (c u c-0 ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx)
    (y-0 expt) (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0)
    (y y-1) (x x-1))
  (deflistener
    (hash &quot;c ap traffic&quot; cr-1 sr-1
      (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr-1 sr-1
      (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (5 0)) ((3 4) (2 4)) ((4 1) (3 3))
    ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener
      (cat &quot;c ap traffic&quot; cr-1 sr-1
        (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
    (hash &quot;c ap traffic&quot; cr-1 sr-1
      (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)) (4 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr-1 sr-1
         (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr-1 sr-1
          (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr-1 sr-1
         (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr-1 sr-1
          (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (label 100)
  (parent 95)
  (unrealized (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k101">Item <a href="#t78">101</a>, Parent: <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-1) y-1)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-1) y-1)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 191.774 337.617 43.707 560.274'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 486.780 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 90.713 374.561 41.505 559.162'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (response response) (request request) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 101</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 cpk-1 akey) (c u c-0 ca c-1 u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx)
    (y-0 expt) (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0)
    (y y-1) (x x-1))
  (deflistener
    (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (6 0)) ((3 4) (2 4)) ((4 1) (3 2)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul x-1 y-1)) (5 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (recv
        (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (invk cpk-1))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
              (invk cpk-1)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
      (send (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
      (send (cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 101)
  (parent 96)
  (unrealized (3 2) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k102">Item <a href="#t78">102</a>, Parent: <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-1) x-1)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-1) x-1)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0))) (invk cpk-1))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle style='fill: red;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 191.774 337.617 43.707 560.274'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 486.780 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 90.713 374.561 41.505 559.162'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (response response) (request request) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 102</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 cpk-1 akey) (c u c-0 ca c-1 u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx)
    (y-0 expt) (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (cpk cpk-1) (c c-1) (u u-0) (s s) (ca ca-0)
    (y y-1) (x x-1))
  (deflistener
    (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 0) (3 0)) ((1 1) (0 1)) ((2 6) (0 3)) ((3 1) (0 1))
    ((3 1) (6 0)) ((3 4) (2 4)) ((4 1) (3 2)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul x-1 y-1)) (5 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (recv
        (enc (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
              c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (invk cpk-1))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c-1 cpk-1 (enc (hash c-1 cpk-1) (privk ca-0)))
              (invk cpk-1)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
      (send (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
    ((recv (cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
      (send (cat (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 102)
  (parent 96)
  (unrealized (3 2) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k103">Item <a href="#t78">103</a>, Parent: <a href="#k97">97</a>, Children: <a href="#k105">105</a> <a href="#k106">106</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-0) (sr sr-0) (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='289.860' y='39.960' style='text-anchor: middle;'>ca 103</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 akey) (c u c-0 ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u)
    (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0)
    (y y-0) (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr-0 sr-0
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr-0 sr-0
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (5 0)) ((2 4) (1 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
    (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) (4 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr-0 sr-0
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr-0 sr-0
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr-0 sr-0
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr-0 sr-0
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
  (label 103)
  (parent 97)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k104">Item <a href="#t78">104</a>, Parent: <a href="#k100">100</a>, Children: <a href="#k107">107</a> <a href="#k108">108</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.810 189.232 45.781 263.504'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 486.780 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 186.900 302.460 333.840 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (response response) (request request) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 104</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 akey) (c u c-0 ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx)
    (y-0 expt) (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0)
    (y y-1) (x x-1))
  (deflistener
    (hash &quot;c ap traffic&quot; cr-1 sr-1
      (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr-1 sr-1
      (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (6 0)) ((3 4) (2 4)) ((4 1) (3 3))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))
    (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;) (5 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr-1 sr-1
         (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr-1 sr-1
          (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr-1 sr-1
         (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr-1 sr-1
          (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
  (label 104)
  (parent 100)
  (unrealized (6 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k105">Item <a href="#t78">105</a>, Parent: <a href="#k103">103</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-0) (sr sr-0) (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 105</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 akey) (c u c-0 ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u)
    (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0)
    (y y-0) (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr-0 sr-0
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr-0 sr-0
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 4) (1 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr-0 sr-0
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr-0 sr-0
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr-0 sr-0
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr-0 sr-0
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 105)
  (parent 103)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k106">Item <a href="#t78">106</a>, Parent: <a href="#k103">103</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='264.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-0) (sr sr-0) (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0) (y y-0) (x x-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))) (response response) (request request) (cr cr-0) (sr sr-0) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='339.840' y='39.960' style='text-anchor: middle;'>ca 106</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 akey) (c u c-0 ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-0) (sr sr-0)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    (any any) (p p) (cr cr) (sr sr) (spk spk) (cpk cpk-0) (c c-0) (u u)
    (s s) (ca ca) (cookiestor cookiestor) (x x) (y y))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-0) (sr sr-0)
    (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0)
    (y y-0) (x x-0))
  (deflistener
    (hash &quot;c ap traffic&quot; cr-0 sr-0
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr-0 sr-0
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 6) (0 3)) ((2 1) (0 1))
    ((2 1) (6 0)) ((2 4) (1 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-0 sr-0)
  (uniq-gen x x-0 y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((1 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x)) s
                  spk (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                    spk (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
                  (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr (exp (gen) y)) (cat sr (exp (gen) x))
                      s spk (enc (hash s spk) (privk ca))) (invk spk)))
                c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
              (invk cpk-0)))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr-0 sr-0
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr-0 sr-0
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr-0 sr-0
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr-0 sr-0
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 106)
  (parent 103)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k107">Item <a href="#t78">107</a>, Parent: <a href="#k104">104</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-1) y-1)</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-1) y-1)</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.583 226.118 45.326 337.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 536.760 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (response response) (request request) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 107</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 akey) (c u c-0 ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx)
    (y-0 expt) (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0)
    (y y-1) (x x-1))
  (deflistener
    (hash &quot;c ap traffic&quot; cr-1 sr-1
      (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr-1 sr-1
      (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-1) y-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (7 0)) ((3 4) (2 4)) ((4 1) (3 3))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-1))
    (exp (gen) (mul x-1 y-1)) (6 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr-1 sr-1
         (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr-1 sr-1
          (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr-1 sr-1
         (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr-1 sr-1
          (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x-1) y-1)) (send (cat (exp (gen) x-1) y-1))))
  (label 107)
  (parent 104)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k108">Item <a href="#t78">108</a>, Parent: <a href="#k104">104</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='904.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 904.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-1) x-1)</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-1) x-1)</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u-0 p-0 (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 189.960 Q 192.583 226.118 45.326 337.276'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 339.840 189.960 Q 536.760 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: blue; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g><title>(ch-msg cookiestor (cat pt-0 any))</title>
   <circle style='fill: gray;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login-successful&quot; (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;login&quot; u p (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) y-0)) (cat sr-0 (exp (gen) x-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat s spk (enc (hash s spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) s spk (enc (hash s spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc response (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='864.960' r='6.000'/></g>
  <g>
   <title>(enc (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))) request (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='789.960' r='6.000'/></g>
  <g>
   <title>(ch-msg cookiestor (cat pt &quot;client store&quot; u s (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))</title>
   <circle style='fill: gray;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 186.900 377.460 333.840 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (cat c cpk (enc (hash c cpk) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) y-1)) (cat sr-1 (exp (gen) x-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat s spk-0 (enc (hash s spk-0) (privk ca-0))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) s spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 186.900 77.460 333.840 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cookie cookie) (p p-0) (cr cr-1) (sr sr-1) (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0) (y y-1) (x x-1))</title>
   <text
    x='339.840' y='77.460' style='text-anchor: middle;'>servera</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0) (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>clienta</text>
   </g>
  <g>
   <title>((cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y) (x x))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>serverr</text>
   </g>
  <g>
   <title>((cookie (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))) (response response) (request request) (cr cr-1) (sr sr-1) (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0) (cookiestor cookiestor) (x x-1) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>clientr</text>
   </g>
  <text
   x='389.820' y='39.960' style='text-anchor: middle;'>ca 108</text>
  </svg></div>

<pre>(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (cpk spk cpk-0 spk-0 akey) (c u c-0 ca u-0 s ca-0 name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx)
    (y-0 expt) (x-1 y-1 rndx))
  (defstrand clientr 6
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (response response) (request request) (cr cr-1) (sr sr-1)
    (spk spk-0) (cpk cpk) (c c) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (x x-1) (y y-1))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk-0) (s s) (ca ca-0) (y y)
    (x x))
  (defstrand clienta 7
    (cookie
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (cpk cpk-0) (c c-0)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (x x-0) (y y-0))
  (defstrand servera 5 (cookie cookie) (p p-0) (cr cr-1) (sr sr-1)
    (ppk ppk) (spk spk-0) (cpk cpk) (c c) (u u-0) (s s) (ca ca-0)
    (y y-1) (x x-1))
  (deflistener
    (hash &quot;c ap traffic&quot; cr-1 sr-1
      (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;c ap traffic&quot; cr-1 sr-1
      (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-1) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 6) (0 3))
    ((3 1) (0 1)) ((3 1) (7 0)) ((3 4) (2 4)) ((4 1) (3 3))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk cpk) (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr-1 sr-1)
  (uniq-gen y x-0 x-1 y-1)
  (absent (y x) (y-1 x-1))
  (gen-st
    (cat &quot;client store&quot; u s
      (enc cookie
        (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
  (facts (neq u-0 s))
  (leads-to ((2 6) (0 3)))
  (rule fact-servera-neq0 trRl_clienta-at-5 trRl_clienta-at-6)
  (operation nonce-test (added-listener (cat (exp (gen) y-1) x-1))
    (exp (gen) (mul x-1 y-1)) (6 0))
  (traces
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (load cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
      (send
        (enc
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          request
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (recv
        (enc response
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                spk-0 (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) s
                  spk-0 (enc (hash s spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
          (enc
            (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                    sr-0)) (cat cr-0 (exp (gen) y-0))
                (cat sr-0 (exp (gen) x-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) y-0))
                    (cat sr-0 (exp (gen) x-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))) c-0
              cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat s spk (enc (hash s spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) s spk
                (enc (hash s spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) y-0))
              (cat sr-0 (exp (gen) x-0))
              (cat s spk (enc (hash s spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0)) s spk
                  (enc (hash s spk) (privk ca))) (invk spk)))
            (cat c-0 cpk-0 (enc (hash c-0 cpk-0) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0))
                (cat s spk (enc (hash s spk) (privk ca)))
                (enc
                  (hash (cat cr-0 (exp (gen) x-0))
                    (cat sr-0 (exp (gen) y-0)) s spk
                    (enc (hash s spk) (privk ca))) (invk spk))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                      sr-0)) (cat cr-0 (exp (gen) y-0))
                  (cat sr-0 (exp (gen) x-0))
                  (cat s spk (enc (hash s spk) (privk ca)))
                  (enc
                    (hash (cat cr-0 (exp (gen) y-0))
                      (cat sr-0 (exp (gen) x-0)) s spk
                      (enc (hash s spk) (privk ca))) (invk spk))) c-0
                cpk-0 (enc (hash c-0 cpk-0) (privk ca))) (invk cpk-0)))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (send
        (enc &quot;login&quot; u p
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (recv
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt &quot;client store&quot; u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
    ((recv (cat cr-1 (exp (gen) x-1)))
      (send
        (cat (cat sr-1 (exp (gen) y-1))
          (enc (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (recv
        (enc (cat c cpk (enc (hash c cpk) (privk ca-0)))
          (enc
            (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
              (hash
                (hash &quot;finished&quot;
                  (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                    sr-1)) (cat cr-1 (exp (gen) y-1))
                (cat sr-1 (exp (gen) x-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) y-1))
                    (cat sr-1 (exp (gen) x-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))) c
              cpk (enc (hash c cpk) (privk ca-0))) (invk cpk))
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) s spk-0
                (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) y-1))
              (cat sr-1 (exp (gen) x-1))
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1)) s spk-0
                  (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
            (cat c cpk (enc (hash c cpk) (privk ca-0)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1))
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (enc
                  (hash (cat cr-1 (exp (gen) x-1))
                    (cat sr-1 (exp (gen) y-1)) s spk-0
                    (enc (hash s spk-0) (privk ca-0))) (invk spk-0))
                (hash
                  (hash &quot;finished&quot;
                    (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                      sr-1)) (cat cr-1 (exp (gen) y-1))
                  (cat sr-1 (exp (gen) x-1))
                  (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                  (enc
                    (hash (cat cr-1 (exp (gen) y-1))
                      (cat sr-1 (exp (gen) x-1)) s spk-0
                      (enc (hash s spk-0) (privk ca-0))) (invk spk-0)))
                c cpk (enc (hash c cpk) (privk ca-0))) (invk cpk)))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc &quot;login&quot; u-0 p-0
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc &quot;login-successful&quot;
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))))
    ((recv
       (hash &quot;c ap traffic&quot; cr-1 sr-1
         (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
      (send
        (hash &quot;c ap traffic&quot; cr-1 sr-1
          (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    ((recv
       (cat &quot;c ap traffic&quot; cr-1 sr-1
         (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
      (send
        (cat &quot;c ap traffic&quot; cr-1 sr-1
          (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y-1) x-1)) (send (cat (exp (gen) y-1) x-1))))
  (label 108)
  (parent 104)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

</body>
</html>
