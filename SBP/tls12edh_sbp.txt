(herald
  "Session Binding Protocol with TLS 1.2 Signed Ephemeral Diffie-Hellman (uses the modified server as implemented and tested in the paper and the cookie authentication model (ca.scm) which showed the cookie stealing attack)."
  (bound 12))

(comment "CPSA 4.4.2")
(comment "All input read from tls12edh_sbp.scm")
(comment "Strand count bounded at 12")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 0)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 1)
  (parent 0)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 2)
  (parent 1)
  (unrealized (0 1) (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 3)
  (parent 2)
  (unrealized (0 3) (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 4)
  (parent 2)
  (unrealized (0 3) (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 5)
  (parent 3)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 6)
  (parent 3)
  (unrealized (0 3) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 7)
  (parent 4)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 8)
  (parent 4)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 servera 6)
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 9)
  (parent 5)
  (unrealized (0 9) (1 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 10)
  (parent 5)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 11)
  (parent 6)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-1)) cr sr)))
      (hash (hash (exp (gen) (mul y x-1)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 12)
  (parent 7)
  (unrealized (0 9) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 13)
  (parent 7)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 14)
  (parent 8)
  (unrealized (0 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 0 clienta 5)
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) "client_write")) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 15)
  (parent 9)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 16)
  (parent 9)
  (unrealized (0 9) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 17)
  (parent 10)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 18)
  (parent 11)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clienta 5)
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 19)
  (parent 12)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 20)
  (parent 12)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 21)
  (parent 13)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 22)
  (parent 14)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 2 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 23)
  (parent 15)
  (unrealized (1 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 24)
  (parent 15)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 25)
  (parent 16)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 26)
  (parent 17)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 27)
  (parent 18)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 28)
  (parent 18)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 3 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 29)
  (parent 19)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 30)
  (parent 19)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 31)
  (parent 20)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 32)
  (parent 21)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 33)
  (parent 22)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 34)
  (parent 22)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((0 8) (1 8))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 0 clienta 9)
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) "client_write")) (1 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 35)
  (parent 23)
  (realized)
  (shape)
  (maps
    ((0)
      ((u u) (s s) (ca ca) (p p) (cr cr) (sr sr) (spk spk) (y y) (x x)
        (cookie
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
        (any any) (cookiestor cookiestor) (request request)
        (response response))))
  (origs (pt-0 (0 7)) (cookie (1 5)) (pt-2 (1 7)) (cr (0 0))
    (sr (1 1))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) (1 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 36)
  (parent 23)
  (unrealized (1 8) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 37)
  (parent 24)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 38)
  (parent 25)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 39)
  (parent 26)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 40)
  (parent 26)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (2 8))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 0 clienta 9)
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 41)
  (parent 29)
  (seen 35)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) (2 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 42)
  (parent 29)
  (unrealized (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 43)
  (parent 30)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 44)
  (parent 31)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 45)
  (parent 32)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 46)
  (parent 32)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 47)
  (parent 36)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 48)
  (parent 37)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 49)
  (parent 38)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 50)
  (parent 38)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 51)
  (parent 42)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 52)
  (parent 43)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 53)
  (parent 44)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 54)
  (parent 44)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 55)
  (parent 47)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 56)
  (parent 48)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 57)
  (parent 48)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 58)
  (parent 51)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 59)
  (parent 52)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 60)
  (parent 52)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 61)
  (parent 55)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 62)
  (parent 55)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 63)
  (parent 58)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 64)
  (parent 58)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie)))
  (label 65)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie)))
  (label 66)
  (parent 65)
  (unrealized (0 1) (0 3))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 67)
  (parent 66)
  (unrealized (0 1) (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (2 0)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 2 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 68)
  (parent 67)
  (unrealized (0 3) (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (3 0)) ((2 1) (0 1)) ((3 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 69)
  (parent 67)
  (unrealized (0 3) (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((2 1) (0 1)) ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 70)
  (parent 68)
  (unrealized (0 5) (0 9))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((2 1) (0 1)) ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 71)
  (parent 68)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((2 1) (0 1)) ((3 1) (0 1))
    ((3 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 4 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 72)
  (parent 69)
  (unrealized (0 5) (0 9))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (4 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 73)
  (parent 69)
  (unrealized (0 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 74)
  (parent 70)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((2 1) (0 1)) ((3 1) (0 3))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 75)
  (parent 71)
  (unrealized (0 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 76)
  (parent 72)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (5 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 77)
  (parent 73)
  (unrealized (0 3) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 78)
  (parent 74)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((2 1) (0 1)) ((3 1) (0 3))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 79)
  (parent 75)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 80)
  (parent 76)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (6 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 81)
  (parent 77)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 82)
  (parent 78)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((2 1) (0 1)) ((3 1) (0 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 83)
  (parent 79)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((2 1) (0 1)) ((3 1) (0 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 84)
  (parent 79)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 85)
  (parent 80)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (7 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 86)
  (parent 81)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (7 0)) ((2 1) (0 1)) ((3 1) (0 1))
    ((4 1) (0 3)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 87)
  (parent 81)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 88)
  (parent 82)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (deflistener cookie)
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 89)
  (parent 82)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 90)
  (parent 85)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (deflistener cookie)
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((2 1) (0 1))
    ((3 1) (0 1)) ((3 3) (0 3)) ((4 1) (0 5)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cookie) (send cookie))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 91)
  (parent 85)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 92)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (rule gen-st-clientr-0)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 93)
  (parent 92)
  (unrealized (0 1) (0 3) (0 4))
  (origs (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 94)
  (parent 93)
  (unrealized (0 1) (0 3) (0 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 95)
  (parent 94)
  (unrealized (0 3) (0 4) (0 6))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 96)
  (parent 94)
  (unrealized (0 3) (0 4) (0 6))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 97)
  (parent 95)
  (unrealized (0 4) (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 98)
  (parent 95)
  (unrealized (0 3) (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (x y x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 99)
  (parent 96)
  (unrealized (0 4) (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 100)
  (parent 96)
  (unrealized (0 3) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 7) (0 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt "client store" u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie))))
  (label 101)
  (parent 97)
  (unrealized (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 102)
  (parent 98)
  (unrealized (0 3) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 7) (0 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor (cat pt "client store" u s cookie)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie))))
  (label 103)
  (parent 99)
  (unrealized (0 6))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 104)
  (parent 100)
  (unrealized (0 3) (0 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 9) (0 6)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 3 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write"))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))))
  (label 105)
  (parent 101)
  (unrealized (2 4) (2 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 1 3 serverr 7)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write"))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))))
  (label 106)
  (parent 101)
  (unrealized (2 4) (2 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 107)
  (parent 101)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 108)
  (parent 102)
  (unrealized (0 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 4 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-2)) cr sr) "server_write"))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))))
  (label 109)
  (parent 103)
  (unrealized (3 4) (3 8))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 gen-st-serverr-0 trRl_clienta-at-6
    trRl_clienta-at-7)
  (operation encryption-test (displaced 2 4 serverr 7)
    (enc response
      (hash (hash (exp (gen) (mul y-0 x-2)) cr sr) "server_write"))
    (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))))
  (label 110)
  (parent 103)
  (unrealized (3 4) (3 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 6))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 111)
  (parent 103)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 112)
  (parent 104)
  (unrealized (0 4) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 113)
  (parent 105)
  (unrealized (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (1 5)) ((0 2) (2 2)) ((0 5) (2 4))
    ((1 7) (0 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clientr 6)
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y-1 x-0)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-1 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write")))))
  (label 114)
  (parent 106)
  (unrealized (1 5) (2 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (enc
      (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 115)
  (parent 106)
  (unrealized (2 4) (2 5) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 116)
  (parent 107)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 117)
  (parent 108)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr random32) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (gen-st (cat "client store" u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 118)
  (parent 108)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 119)
  (parent 109)
  (unrealized (3 8) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (x-1 y-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (2 5)) ((0 2) (3 2)) ((0 5) (3 4))
    ((1 1) (0 1)) ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 6) (0 6)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y x-1 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 4 0 clientr 6)
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y-1 x-1)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-1 x-1)) cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write")))))
  (label 120)
  (parent 110)
  (unrealized (2 5) (3 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (enc
      (enc cookie-0 (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 121)
  (parent 110)
  (unrealized (3 4) (3 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 122)
  (parent 111)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 123)
  (parent 112)
  (unrealized (0 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie mesg) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (spk akey) (s ca u s-0 ca-0 name)
    (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (absent (y x-0))
  (gen-st (cat "client store" u s cookie))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 124)
  (parent 112)
  (unrealized (0 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 125)
  (parent 113)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk ppk-0 skey)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1)
    (authstor authstor) (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (1 5)) ((0 2) (2 2)) ((0 5) (2 4))
    ((1 7) (0 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6))
    ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (2 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul x-1 y-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul x-1 y-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)))
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 126)
  (parent 114)
  (unrealized (1 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 127)
  (parent 115)
  (unrealized (2 4) (2 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 128)
  (parent 116)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 129)
  (parent 119)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk ppk-0 skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (ppk ppk-0) (spk spk-0) (u u-0) (s s) (ca ca-0)
    (authstor authstor) (x x-1) (y y-1))
  (precedes ((0 0) (2 0)) ((0 2) (1 5)) ((0 2) (2 2)) ((0 5) (2 4))
    ((1 7) (0 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6))
    ((3 1) (0 1)) ((3 5) (1 5)) ((3 7) (2 5)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (displaced 1 4 servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 130)
  (parent 120)
  (unrealized (1 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32) (ppk ppk-0 skey)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (x y rndx)
    (x-0 expt) (x-1 y-0 x-2 rndx) (y-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-2)
    (sr sr-2) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1)
    (authstor authstor) (x x-2) (y y-1))
  (precedes ((0 0) (3 0)) ((0 2) (2 5)) ((0 2) (3 2)) ((0 5) (3 4))
    ((1 1) (0 1)) ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 6) (0 6)) ((4 5) (2 5)) ((4 7) (3 5)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-1 y-0 x-2)
  (absent (y x-0) (y-0 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)) ((4 7) (3 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation channel-test (added-strand servera 8)
    (ch-msg authstor (cat pt-1 "server store" s u-0 cookie)) (3 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write"))))
    ((recv cr-2)
      (send
        (cat sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-2)
          (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul x-2 y-1)) "client finished"
              (hash cr-2 sr-2
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-2)
                  (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-2 y-1)) "server finished"
            (hash cr-2 sr-2
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-2)
                (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul x-2 y-1)) "client finished"
                  (hash cr-2 sr-2
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-2)
                      (enc (hash cr-2 sr-2 (exp (gen) x-2))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            "client_write")))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)))
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie))))
  (label 131)
  (parent 120)
  (unrealized (2 5))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 132)
  (parent 121)
  (unrealized (3 4) (3 5) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 133)
  (parent 122)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 134)
  (parent 125)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk ppk-0 skey)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (y rndx)
    (x expt) (x-0 y-0 x-1 rndx) (y-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1)
    (authstor authstor) (x x-1) (y y-1))
  (deflistener (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 5) (2 4))
    ((1 7) (0 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6))
    ((3 5) (1 5)) ((3 7) (2 5)) ((4 1) (1 5)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
    (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
    (1 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul x-1 y-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul x-1 y-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)))
          (hash (hash (exp (gen) (mul x-1 y-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie)))
    ((recv (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
  (label 135)
  (parent 126)
  (unrealized (1 5) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 136)
  (parent 127)
  (unrealized (2 4) (2 5) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 137)
  (parent 128)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-0))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (0 6)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 138)
  (parent 128)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 139)
  (parent 129)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk ppk-0 skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (x-0 y-0 rndx)
    (y-1 expt) (x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-1)
    (sr sr-1) (ppk ppk-0) (spk spk-0) (u u-0) (s s) (ca ca-0)
    (authstor authstor) (x x-1) (y y-1))
  (deflistener (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 5) (2 4))
    ((1 7) (0 4)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6))
    ((3 1) (0 1)) ((3 5) (1 5)) ((3 7) (2 5)) ((4 1) (1 5)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y x-0 y-0 x-1)
  (absent (y x) (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)) ((3 7) (2 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
    (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
    (1 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-0 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-0 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y-0)) cr sr)
            "server_write"))))
    ((recv cr-1)
      (send
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul y-1 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-1 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul y-1 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "client_write")))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)))
          (hash (hash (exp (gen) (mul y-1 x-1)) cr-1 sr-1)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie)))
    ((recv (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul x-0 y-0)) cr sr)))))
  (label 140)
  (parent 130)
  (unrealized (1 5) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32) (ppk ppk-0 skey)
    (spk spk-0 spk-1 akey) (u ca u-0 s ca-0 ca-1 name)
    (pt pt-0 pt-1 pt-2 pval) (cookiestor authstor locn) (x y rndx)
    (x-0 expt) (x-1 y-0 x-2 rndx) (y-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (defstrand servera 8 (any any-0) (cookie cookie) (p p-0) (cr cr-2)
    (sr sr-2) (ppk ppk-0) (spk spk-1) (u u-0) (s s) (ca ca-1)
    (authstor authstor) (x x-2) (y y-1))
  (deflistener (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((0 5) (3 4))
    ((1 1) (0 1)) ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3))
    ((3 6) (0 6)) ((4 5) (2 5)) ((4 7) (3 5)) ((5 1) (2 5)))
  (non-orig ppk ppk-0 (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-1 y-0 x-2)
  (absent (y x-0) (y-0 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))
    (cat "server store" s u-0 cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)) ((4 7) (3 5)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
    (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
    (2 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul x-1 y-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-1 y-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul x-1 y-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-1 y-0)) cr sr)
            "server_write"))))
    ((recv cr-2)
      (send
        (cat sr-2 (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
          (exp (gen) x-2)
          (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1))))
      (recv
        (cat (exp (gen) y-1)
          (enc
            (hash (exp (gen) (mul x-2 y-1)) "client finished"
              (hash cr-2 sr-2
                (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                (cat (exp (gen) x-2)
                  (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))
                (exp (gen) y-1)))
            (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-2 y-1)) "server finished"
            (hash cr-2 sr-2
              (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
              (cat (exp (gen) x-2)
                (enc (hash cr-2 sr-2 (exp (gen) x-2)) (invk spk-1)))
              (exp (gen) y-1)
              (enc
                (hash (exp (gen) (mul x-2 y-1)) "client finished"
                  (hash cr-2 sr-2
                    (cat s spk-1 (enc (hash s spk-1) (privk ca-1)))
                    (cat (exp (gen) x-2)
                      (enc (hash cr-2 sr-2 (exp (gen) x-2))
                        (invk spk-1))) (exp (gen) y-1)))
                (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            "client_write")))
      (send
        (enc "login-successful"
          (enc cookie
            (hash ppk-0 (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)))
          (hash (hash (exp (gen) (mul x-2 y-1)) cr-2 sr-2)
            "server_write"))) (load authstor (cat pt-2 any-0))
      (stor authstor (cat pt-1 "server store" s u-0 cookie)))
    ((recv (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul x-1 y-0)) cr sr)))))
  (label 141)
  (parent 131)
  (unrealized (2 5) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 142)
  (parent 132)
  (unrealized (3 4) (3 5) (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 143)
  (parent 133)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk-0) (u u) (s s) (ca ca-0) (cookiestor cookiestor)
    (y y-0) (x x-1))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (0 6))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 144)
  (parent 133)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 145)
  (parent 134)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 9) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 146)
  (parent 134)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 147)
  (parent 136)
  (unrealized (2 4) (2 5) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk spk-0 akey) (u ca u-0 s ca-0 name)
    (pt pt-0 pt-1 pval) (cookiestor authstor locn) (y rndx) (x expt)
    (y-0 x-0 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-0)
    (sr sr-0) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 6) (0 6)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 148)
  (parent 136)
  (unrealized (2 4) (2 5) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 149)
  (parent 139)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any any-0 mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p p-0 password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand servera 10 (any any-0) (cookie cookie-0)
    (response response) (request request-0) (p p-0) (cr cr) (sr sr)
    (ppk ppk) (spk spk-0) (u u-0) (s s) (ca ca-0) (authstor authstor)
    (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 9) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie-0 cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u-0 cookie-0))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 150)
  (parent 139)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 151)
  (parent 142)
  (unrealized (3 4) (3 5) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie any mesg) (cookie-0 data) (response httpdata)
    (request request-0 httpreq) (p password)
    (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey) (spk spk-0 akey)
    (u ca u-0 s ca-0 name) (pt pt-0 pt-1 pval)
    (cookiestor authstor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7 (cookie cookie) (response response)
    (request request) (cr cr) (sr sr) (spk spk-0) (u u) (s s) (ca ca-0)
    (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8 (cookie cookie) (any any) (p p) (cr cr-1)
    (sr sr-1) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor)
    (y y) (x x-0))
  (defstrand serverr 7 (cookie cookie-0) (response response)
    (request request-0) (cr cr) (sr sr) (ppk ppk) (spk spk-0) (u u-0)
    (s s) (ca ca-0) (authstor authstor) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 6) (0 6))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0) (y-0 x-1))
  (gen-st (cat "client store" u s cookie)
    (cat "server store" s u-0 cookie-0))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-serverr-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor (cat pt "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor (cat pt "client store" u s cookie)))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc
          (enc cookie-0
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))) request-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (load authstor (cat pt-1 "server store" s u-0 cookie-0))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 152)
  (parent 142)
  (unrealized (3 4) (3 5) (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca)
    (authstor authstor) (x x) (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))))
  (label 153)
  (realized)
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca)
    (authstor authstor) (x x) (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie sr)
  (uniq-gen x)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-6 trRl_servera-at-7)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))))
  (label 154)
  (parent 153)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (cookie cookie) (spk spk) (u u)
        (x x) (y y) (p p) (ppk ppk) (any any) (authstor authstor)
        (request request))))
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5))))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca)
    (authstor authstor) (x x) (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))))
  (label 155)
  (realized)
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (request httpreq) (p password)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pt-0 pval)
    (authstor locn) (x rndx) (y expt))
  (defstrand servera 9 (any any) (cookie cookie) (request request) (p p)
    (cr cr) (sr sr) (ppk ppk) (spk spk) (u u) (s s) (ca ca)
    (authstor authstor) (x x) (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x)
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_servera-at-6 trRl_servera-at-7)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt any))
      (stor authstor (cat pt-0 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))))
  (label 156)
  (parent 155)
  (realized)
  (shape)
  (maps
    ((0)
      ((s s) (ca ca) (cr cr) (sr sr) (cookie cookie) (spk spk) (u u)
        (x x) (y y) (p p) (ppk ppk) (any any) (authstor authstor)
        (request request))))
  (origs (pt-0 (0 7)) (sr (0 1)) (cookie (0 5))))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (ppk skey)
    (spk akey) (s ca u name) (pt pval) (authstor locn) (x rndx)
    (y expt))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x)
    (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig sr)
  (uniq-gen x)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat pt "server store" s u cookie))))
  (label 157)
  (unrealized (0 4))
  (origs (sr (0 1)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (ppk skey)
    (spk akey) (s ca u name) (pt pval) (authstor locn) (x rndx)
    (y expt))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x)
    (y y))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig sr)
  (uniq-gen x)
  (gen-st (cat "server store" s u cookie))
  (facts (neq u s))
  (rule fact-serverr-neq0 gen-st-serverr-0)
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat pt "server store" s u cookie))))
  (label 158)
  (parent 157)
  (unrealized (0 4) (0 5))
  (origs (sr (0 1)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (request httpreq) (cr sr random32) (ppk skey)
    (spk akey) (s ca u name) (pt pval) (authstor locn) (x rndx)
    (y expt))
  (defstrand serverr 6 (cookie cookie) (request request) (cr cr) (sr sr)
    (ppk ppk) (spk spk) (u u) (s s) (ca ca) (authstor authstor) (x x)
    (y y))
  (deflistener (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
  (precedes ((0 1) (1 0)) ((1 1) (0 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig sr)
  (uniq-gen x)
  (gen-st (cat "server store" s u cookie))
  (facts (neq u s))
  (rule fact-serverr-neq0)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
    (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))) (0 4))
  (traces
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat pt "server store" s u cookie)))
    ((recv (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
  (label 159)
  (parent 158)
  (unrealized (0 5) (1 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (goals
    (forall
      ((cookie data) (p password) (cr sr random32) (spk akey)
        (u s ca name) (y rndx) (x expt) (z z-0 strd))
      (implies
        (and (p "clienta" z 10) (p "" z-0 2)
          (p "clienta" "cookie" z cookie) (p "clienta" "p" z p)
          (p "clienta" "cr" z cr) (p "clienta" "sr" z sr)
          (p "clienta" "spk" z spk) (p "clienta" "u" z u)
          (p "clienta" "s" z s) (p "clienta" "ca" z ca)
          (p "clienta" "y" z y) (p "clienta" "x" z x)
          (p "" "x" z-0 cookie) (non (invk spk)) (non (privk ca))
          (pnon p) (uniq sr) (ugen y) (uniq-at cr z 0)) (false))))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 160)
  (unrealized (1 1) (1 3))
  (origs (pt-0 (1 7)) (cr (1 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 161)
  (parent 160)
  (unrealized (1 1) (1 3))
  (origs (pt-0 (1 7)) (cr (1 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((2 1) (1 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 162)
  (parent 161)
  (unrealized (1 1) (1 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((1 0) (2 0)) ((2 1) (1 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 2 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 163)
  (parent 162)
  (unrealized (1 3) (1 5) (1 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((1 0) (3 0)) ((2 1) (1 1)) ((3 1) (1 1)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (1 1))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 164)
  (parent 162)
  (unrealized (1 3) (1 5) (1 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((2 1) (1 1)) ((2 3) (1 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 165)
  (parent 163)
  (unrealized (1 5) (1 9))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (3 0)) ((2 1) (1 1)) ((3 1) (1 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 166)
  (parent 163)
  (unrealized (1 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((2 1) (1 1)) ((3 1) (1 1))
    ((3 3) (1 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 4 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 167)
  (parent 164)
  (unrealized (1 5) (1 9))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (4 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (1 3))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 168)
  (parent 164)
  (unrealized (1 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (3 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 169)
  (parent 165)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (4 0)) ((2 1) (1 1)) ((3 1) (1 3))
    ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 170)
  (parent 166)
  (unrealized (1 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (4 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc "login-successful" cookie
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (1 5))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 171)
  (parent 167)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (5 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 172)
  (parent 168)
  (unrealized (1 3) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (4 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (3 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 173)
  (parent 169)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (5 0)) ((2 1) (1 1)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 174)
  (parent 170)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (5 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 175)
  (parent 171)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (6 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 176)
  (parent 172)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (5 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 177)
  (parent 173)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (6 0)) ((2 1) (1 1)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 178)
  (parent 174)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (6 0)) ((2 1) (1 1)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 179)
  (parent 174)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 180)
  (parent 175)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (7 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 181)
  (parent 176)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (7 0)) ((2 1) (1 1)) ((3 1) (1 1))
    ((4 1) (1 3)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 182)
  (parent 176)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 183)
  (parent 177)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((1 0) (2 0)) ((1 2) (2 2)) ((1 2) (6 0)) ((2 1) (1 1))
    ((2 3) (1 3)) ((3 1) (1 5)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 184)
  (parent 177)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 185)
  (parent 180)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (deflistener cookie)
  (defstrand clienta 10 (cookie cookie) (any any) (response response)
    (request request) (p p) (cr cr) (sr sr) (spk spk) (u u) (s s)
    (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((1 0) (3 0)) ((1 2) (3 2)) ((1 2) (7 0)) ((2 1) (1 1))
    ((3 1) (1 1)) ((3 3) (1 3)) ((4 1) (1 5)) ((5 1) (4 0))
    ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (pen-non-orig p)
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces ((recv cookie) (send cookie))
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor (cat pt-0 "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 186)
  (parent 180)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (goals
    (forall
      ((cookie data) (cr sr random32) (spk akey) (u s ca name) (y rndx)
        (x expt) (ppk skey) (z strd))
      (implies
        (and (p "clienta" z 10)
          (p "clienta" "cookie" z
            (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
          (p "clienta" "cr" z cr) (p "clienta" "sr" z sr)
          (p "clienta" "spk" z spk) (p "clienta" "u" z u)
          (p "clienta" "s" z s) (p "clienta" "ca" z ca)
          (p "clienta" "y" z y) (p "clienta" "x" z x) (non (invk spk))
          (non (privk ca)) (non ppk) (uniq sr) (ugen y)
          (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p "servera" "cookie" z-0 cookie)
            (p "servera" "spk" z-0 spk) (p "servera" "u" z-0 u)
            (p "servera" "s" z-0 s) (p "servera" "ca" z-0 ca)
            (uniq-at cookie z-0 5) (fact neq u s))))))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 187)
  (unrealized (0 1) (0 3) (0 5))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 188)
  (parent 187)
  (unrealized (0 1) (0 3) (0 5))
  (origs (pt-0 (0 7)) (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (y rndx) (x expt)
    (x-0 rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 189)
  (parent 188)
  (unrealized (0 1) (0 3) (0 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 190)
  (parent 189)
  (unrealized (0 3) (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 191)
  (parent 189)
  (unrealized (0 3) (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 192)
  (parent 190)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 193)
  (parent 190)
  (unrealized (0 3) (0 5) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 194)
  (parent 191)
  (unrealized (0 5) (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 195)
  (parent 191)
  (unrealized (0 3) (0 5) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 2 servera 6)
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 196)
  (parent 192)
  (unrealized (0 9) (1 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 197)
  (parent 192)
  (unrealized (0 5) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 198)
  (parent 193)
  (unrealized (0 3) (0 5) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 3 servera 6)
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-1)) cr sr)))
      (hash (hash (exp (gen) (mul y x-1)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 199)
  (parent 194)
  (unrealized (0 9) (2 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc "login-successful"
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 200)
  (parent 194)
  (unrealized (0 5) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 201)
  (parent 195)
  (unrealized (0 3) (0 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 0 clienta 5)
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) "client_write")) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 202)
  (parent 196)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 203)
  (parent 196)
  (unrealized (0 9) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 204)
  (parent 197)
  (unrealized (0 5) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 205)
  (parent 198)
  (unrealized (0 5) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 3 0 clienta 5)
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 206)
  (parent 199)
  (unrealized (0 9))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 207)
  (parent 199)
  (unrealized (0 9) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 208)
  (parent 200)
  (unrealized (0 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 209)
  (parent 201)
  (unrealized (0 5) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 1 2 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 210)
  (parent 202)
  (unrealized (1 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 211)
  (parent 202)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 212)
  (parent 203)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 213)
  (parent 204)
  (unrealized (0 5) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 214)
  (parent 205)
  (unrealized (0 5) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 215)
  (parent 205)
  (unrealized (0 5) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((2 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 3 servera 10)
    (enc response
      (hash (hash (exp (gen) (mul x-1 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 216)
  (parent 206)
  (unrealized (2 8))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (enc response
      (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")) (0 9))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 217)
  (parent 206)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 218)
  (parent 207)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 219)
  (parent 208)
  (unrealized (0 5) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 220)
  (parent 209)
  (unrealized (0 5) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca s-0 ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (y x x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 221)
  (parent 209)
  (unrealized (0 5) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((0 8) (1 8))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 2 0 clienta 9)
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-0 x)) cr sr) "client_write")) (1 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))))
  (label 222)
  (parent 210)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cookie cookie) (cr cr) (sr sr) (spk spk) (u u) (s s) (ca ca)
        (y y) (x x) (ppk ppk) (p p) (any any) (cookiestor cookiestor)
        (request request) (response response))))
  (origs (pt-0 (0 7)) (cookie (1 5)) (pt-2 (1 7)) (sr (1 1))
    (cr (0 0))))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")) (1 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 223)
  (parent 210)
  (unrealized (1 8) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x y)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
  (label 224)
  (parent 211)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 225)
  (parent 212)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 226)
  (parent 213)
  (unrealized (0 5) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 227)
  (parent 213)
  (unrealized (0 5) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request httpreq) (p password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((0 8) (2 8))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test (displaced 3 0 clienta 9)
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))))
  (label 228)
  (parent 216)
  (seen 222)
  (realized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      request-0
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")) (2 8))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 229)
  (parent 216)
  (unrealized (2 8) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
  (label 230)
  (parent 217)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 231)
  (parent 218)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 232)
  (parent 219)
  (unrealized (0 5) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 233)
  (parent 219)
  (unrealized (0 5) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "client_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
  (label 234)
  (parent 223)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) cr sr))
    (hash (exp (gen) (mul x y)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr))))
  (label 235)
  (parent 224)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 236)
  (parent 225)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 237)
  (parent 225)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))))
  (label 238)
  (parent 229)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) cr sr))
    (hash (exp (gen) (mul x-0 y)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr))))
  (label 239)
  (parent 230)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 240)
  (parent 231)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u u-0 s ca name) (pt pt-0 pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u-0) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (facts (neq u-0 s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 241)
  (parent 231)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 242)
  (parent 234)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 243)
  (parent 235)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr random32) (ppk skey) (spk akey) (u s ca name)
    (pt pt-0 pval) (cookiestor locn) (x y rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x y)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (0 9))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x y)) cr sr))
      (send (cat (exp (gen) (mul x y)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 244)
  (parent 235)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 245)
  (parent 238)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 246)
  (parent 239)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (u s ca name) (pt pt-0 pval) (cookiestor locn) (x x-0 y rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 6 (cookie cookie) (p p) (cr cr) (sr sr) (ppk ppk)
    (spk spk) (u u) (s s) (ca ca) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul x-0 y)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((3 1) (0 9)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x x-0 y)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x-0 y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x-0 y)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x-0 y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x-0 y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x-0 y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x-0 y)) cr sr)))
          (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul x-0 y)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul x-0 y)) cr sr))
      (send (cat (exp (gen) (mul x-0 y)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 247)
  (parent 239)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 248)
  (parent 242)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr random32) (ppk skey)
    (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (y x rndx))
  (defstrand clienta 10
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x) (y y))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((0 4) (1 4))
    ((1 1) (0 1)) ((1 3) (0 3)) ((1 5) (0 5)) ((1 9) (0 9))
    ((2 1) (1 8)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen y x)
  (absent (y x))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 249)
  (parent 242)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 250)
  (parent 245)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any any-0 mesg) (cookie data) (response httpdata)
    (request request-0 httpreq) (p password) (cr sr cr-0 sr-0 random32)
    (ppk skey) (spk akey) (u s ca name) (pt pt-0 pt-1 pt-2 pval)
    (cookiestor authstor locn) (x y x-0 rndx))
  (defstrand clienta 10
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (response response) (request request) (p p) (cr cr)
    (sr sr) (spk spk) (u u) (s s) (ca ca) (cookiestor cookiestor) (y y)
    (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand servera 10 (any any-0) (cookie cookie) (response response)
    (request request-0) (p p) (cr cr) (sr sr) (ppk ppk) (spk spk) (u u)
    (s s) (ca ca) (authstor authstor) (x x-0) (y y))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((0 4) (2 4))
    ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5))
    ((2 9) (0 9)) ((3 1) (2 8)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (non-orig ppk (invk spk) (privk ca))
  (uniq-orig cookie cr sr)
  (uniq-gen x y x-0)
  (absent (y x-0))
  (facts (neq u s))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7
    trRl_servera-at-6 trRl_servera-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor (cat pt any))
      (stor cookiestor
        (cat pt-0 "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load authstor (cat pt-1 any-0))
      (stor authstor (cat pt-2 "server store" s u cookie))
      (recv
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request-0
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 251)
  (parent 245)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol ca basic
  (defrole clienta
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (p password) (cookie any mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc "login-successful" cookie
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor any)
      (stor cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x)))
  (defrole clientr
    (vars (u s ca name) (cr sr random32) (y rndx) (x expt) (spk akey)
      (cookie mesg) (cookiestor locn) (request httpreq)
      (response httpdata))
    (trace (send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor (cat "client store" u s cookie))
      (send
        (enc cookie request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    (uniq-gen y)
    (absent (y x))
    (gen-st (cat "client store" u s cookie)))
  (defrole servera
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (p password) (cookie data) (ppk skey) (any mesg) (authstor locn)
      (request httpreq) (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc "login" u p
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (load authstor any)
      (stor authstor (cat "server store" s u cookie))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-orig cookie)
    (uniq-gen x)
    (facts (neq u s)))
  (defrole serverr
    (vars (u s ca name) (cr sr random32) (x rndx) (y expt) (spk akey)
      (cookie data) (ppk skey) (authstor locn) (request httpreq)
      (response httpdata))
    (trace (recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul x y)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul x y)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul x y)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul x y)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul x y)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write")))
      (recv
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr)))
          request
          (hash (hash (exp (gen) (mul x y)) cr sr) "client_write")))
      (load authstor (cat "server store" s u cookie))
      (send
        (enc response
          (hash (hash (exp (gen) (mul x y)) cr sr) "server_write"))))
    (non-orig ppk)
    (uniq-gen x)
    (facts (neq u s))
    (gen-st (cat "server store" s u cookie)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (defgenrule scissorsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (leads-to z0 i0 z2 i2))
        (and (= z1 z2) (= i1 i2)))))
  (defgenrule cakeRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (leads-to z0 i0 z1 i1)
          (leads-to z0 i0 z2 i2) (prec z1 i1 z2 i2)) (false))))
  (defgenrule no-interruption
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (leads-to z0 i0 z2 i2) (trans z1 i1)
          (same-locn z0 i0 z1 i1) (prec z0 i0 z1 i1) (prec z1 i1 z2 i2))
        (false))))
  (defgenrule shearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (trans z2 i2)
          (leads-to z0 i0 z1 i1) (same-locn z0 i0 z2 i2)
          (prec z0 i0 z2 i2))
        (or (and (= z1 z2) (= i1 i2)) (prec z1 i1 z2 i2)))))
  (defgenrule invShearsRule
    (forall ((z0 z1 z2 strd) (i0 i1 i2 indx))
      (implies
        (and (trans z0 i0) (trans z1 i1) (same-locn z0 i0 z1 i1)
          (leads-to z1 i1 z2 i2) (prec z0 i0 z2 i2))
        (or (and (= z0 z1) (= i0 i1)) (prec z0 i0 z1 i1)))))
  (defgenrule fact-servera-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "servera" z (idx 5)) (p "servera" "s" z s)
          (p "servera" "u" z u)) (fact neq u s))))
  (defgenrule fact-serverr-neq0
    (forall ((z strd) (s u name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "s" z s)
          (p "serverr" "u" z u)) (fact neq u s))))
  (defgenrule trRl_clienta-at-7
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_clienta-at-6
    (forall ((z strd))
      (implies (p "clienta" z (idx 8)) (trans z (idx 6)))))
  (defgenrule trRl_servera-at-7
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 7)))))
  (defgenrule trRl_servera-at-6
    (forall ((z strd))
      (implies (p "servera" z (idx 8)) (trans z (idx 6)))))
  (defgenrule gen-st-clientr-0
    (forall ((z strd) (cookie mesg) (s u name))
      (implies
        (and (p "clientr" z (idx 5)) (p "clientr" "cookie" z cookie)
          (p "clientr" "s" z s) (p "clientr" "u" z u))
        (gen-st (cat "client store" u s cookie)))))
  (defgenrule gen-st-serverr-0
    (forall ((z strd) (cookie data) (u s name))
      (implies
        (and (p "serverr" z (idx 6)) (p "serverr" "cookie" z cookie)
          (p "serverr" "u" z u) (p "serverr" "s" z s))
        (gen-st (cat "server store" s u cookie)))))
  (lang (random32 atom) (password atom) (httpreq atom) (httpdata atom)))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (goals
    (forall
      ((cookie data) (cr sr random32) (spk akey) (s ca u name) (y rndx)
        (x expt) (ppk skey) (z strd))
      (implies
        (and (p "clientr" z 7)
          (p "clientr" "cookie" z
            (enc cookie (hash ppk (hash (exp (gen) (mul x y)) cr sr))))
          (p "clientr" "cr" z cr) (p "clientr" "sr" z sr)
          (p "clientr" "spk" z spk) (p "clientr" "u" z u)
          (p "clientr" "s" z s) (p "clientr" "ca" z ca)
          (p "clientr" "y" z y) (p "clientr" "x" z x) (non (invk spk))
          (non (privk ca)) (uniq sr) (ugen y) (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p "servera" "cookie" z-0 cookie)
            (p "servera" "spk" z-0 spk) (p "servera" "u" z-0 u)
            (p "servera" "s" z-0 s) (p "servera" "ca" z-0 ca)
            (uniq-at cookie z-0 5) (fact neq u s))))))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 252)
  (unrealized (0 1) (0 3))
  (origs (cr (0 0)))
  (comment "Not closed under rules"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y rndx) (x expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (rule gen-st-clientr-0)
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 253)
  (parent 252)
  (unrealized (0 1) (0 3) (0 4))
  (origs (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey) (s ca u name)
    (pt pval) (cookiestor locn) (y rndx) (x expt) (x-0 rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash s spk) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk))))))
  (label 254)
  (parent 253)
  (unrealized (0 1) (0 3) (0 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation encryption-test (displaced 2 1 serverr 2)
    (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))))
  (label 255)
  (parent 254)
  (unrealized (0 3) (0 4) (0 6))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (s ca u s-0 ca-0 name) (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation encryption-test (added-strand serverr 2)
    (enc (hash cr sr (exp (gen) x-0)) (invk spk)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))))
  (label 256)
  (parent 254)
  (unrealized (0 3) (0 4) (0 6))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation encryption-test (displaced 1 2 serverr 4)
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))))
  (label 257)
  (parent 255)
  (unrealized (0 4) (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (2 0)) ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x)
            (enc (hash cr sr (exp (gen) x)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 258)
  (parent 255)
  (unrealized (0 3) (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey) (s ca u name)
    (pt pval) (cookiestor locn) (x y x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation encryption-test (displaced 2 3 serverr 4)
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))))
  (label 259)
  (parent 256)
  (unrealized (0 4) (0 6))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (s ca u s-0 ca-0 name) (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (enc
      (hash (exp (gen) (mul y x-0)) "server finished"
        (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
          (cat (exp (gen) x-0)
            (enc (hash cr sr (exp (gen) x-0)) (invk spk))) (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send
        (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 260)
  (parent 256)
  (unrealized (0 3) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (2 5)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor
      (cat pt "client store" u s
        (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
    (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))))
  (label 261)
  (parent 257)
  (unrealized (0 6) (2 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (precedes ((0 0) (1 0)) ((0 2) (3 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x)) cr sr) "server_write") (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
  (label 262)
  (parent 258)
  (unrealized (0 3) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 5)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation channel-test (added-strand clienta 8)
    (ch-msg cookiestor
      (cat pt "client store" u s
        (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
    (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))))
  (label 263)
  (parent 259)
  (unrealized (0 6) (3 5))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (s ca u s-0 ca-0 name) (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (precedes ((0 0) (2 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
  (label 264)
  (parent 260)
  (unrealized (0 3) (0 4) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 7) (0 4)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (1 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 1 3 servera 6)
    (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
    (2 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write")))))
  (label 265)
  (parent 261)
  (unrealized (0 6) (1 5) (2 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (3 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (2 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
    (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))) (2 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (label 266)
  (parent 261)
  (unrealized (0 6) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 267)
  (parent 262)
  (unrealized (0 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((1 1) (0 1)) ((2 7) (0 4))
    ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test (displaced 2 4 servera 6)
    (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-2)) cr sr)))
    (3 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write")))))
  (label 268)
  (parent 263)
  (unrealized (0 6) (2 5) (3 4))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (3 5)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
    (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))) (3 5))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (label 269)
  (parent 263)
  (unrealized (0 6) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (s ca u s-0 ca-0 name) (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 270)
  (parent 264)
  (unrealized (0 4) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (3 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 271)
  (parent 265)
  (unrealized (0 6) (1 5) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (2 5)) ((4 1) (3 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
    (hash ppk (hash (exp (gen) (mul y x)) cr sr)) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (label 272)
  (parent 266)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 273)
  (parent 267)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr random32) (ppk skey) (spk akey) (s ca u name) (pt pval)
    (cookiestor locn) (y x rndx))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x))
  (deflistener (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (5 0)) ((1 1) (0 1)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 274)
  (parent 267)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5))
    ((4 1) (3 4)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (enc "login" u-0 p-0
      (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (3 4))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 275)
  (parent 268)
  (unrealized (0 6) (2 5) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (3 5))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
    (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (label 276)
  (parent 269)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (s ca u s-0 ca-0 name) (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 277)
  (parent 270)
  (unrealized (0 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (cookie data) (response httpdata) (request httpreq)
    (cr sr cr-0 sr-0 random32) (ppk skey) (spk akey)
    (s ca u s-0 ca-0 name) (pt pval) (cookiestor locn) (y x x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 2 (cr cr) (sr sr) (spk spk) (s s-0) (ca ca-0)
    (x x-0))
  (deflistener
    (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (6 0)) ((1 1) (0 1)) ((2 1) (0 1))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x x-0)
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s-0 spk (enc (hash s-0 spk) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk)))))
    ((recv (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))
      (send (cat (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 278)
  (parent 270)
  (unrealized (0 4) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (4 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write") (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))))
  (label 279)
  (parent 271)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (2 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) cr sr))
    (hash (exp (gen) (mul y x)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr))))
  (label 280)
  (parent 272)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5))
    ((4 1) (3 4)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener
      (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write") (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))))
  (label 281)
  (parent 275)
  (unrealized (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (3 5))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x-0)) cr sr))
    (hash (exp (gen) (mul y x-0)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr))))
  (label 282)
  (parent 276)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-0)) cr sr))
    (hash (exp (gen) (mul y-0 x-0)) cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr))))
  (label 283)
  (parent 279)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (2 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 284)
  (parent 280)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 random32) (ppk skey) (spk spk-0 akey)
    (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn) (y x y-0 rndx)
    (x-0 expt))
  (defstrand clientr 7
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x)
    (y y))
  (defstrand clienta 8
    (cookie (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (deflistener (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
  (deflistener (cat (exp (gen) (mul y x)) cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 7) (0 4)) ((3 1) (2 5)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x y-0)
  (absent (y-0 x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
  (leads-to ((2 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))))
      (send
        (enc (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca))) (exp (gen) x)
          (enc (hash cr sr (exp (gen) x)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr sr (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr sr) "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr sr (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr sr (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr sr) "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr-0 sr-0
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr-0 sr-0
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr-0 sr-0 (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-0 sr-0 (exp (gen) x-0))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr-0 sr-0)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x)) cr sr))))
    ((recv (cat (exp (gen) (mul y x)) cr sr))
      (send (cat (exp (gen) (mul y x)) cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 285)
  (parent 280)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (6 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y-0 x-1)) cr sr))
    (hash (exp (gen) (mul y-0 x-1)) cr sr) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr))))
  (label 286)
  (parent 281)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (3 5))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 287)
  (parent 282)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (s ca u ca-0 name) (pt pt-0 pval) (cookiestor locn)
    (x y x-0 y-0 rndx) (x-1 expt))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk)
    (u u) (s s) (ca ca) (cookiestor cookiestor) (y y) (x x-0))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk) (s s) (ca ca)
    (x x))
  (defstrand serverr 4 (cr cr) (sr sr) (spk spk) (s s) (ca ca) (x x-0)
    (y y))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk-0) (u u) (s s)
    (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (deflistener (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
  (deflistener (cat (exp (gen) (mul y x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 7) (0 4)) ((4 1) (3 5))
    ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y x-0 y-0)
  (absent (y-0 x-1))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
  (leads-to ((3 7) (0 4)))
  (rule trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul y x-0)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))))
    ((recv cr)
      (send
        (cat sr (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk))))
      (recv
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr sr (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr sr) "server_write"))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr-1 sr-1
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr-1 sr-1
              (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr-1 sr-1 (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr-1 sr-1 (exp (gen) x-1))
                        (invk spk-0))) (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))))
    ((recv (hash ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (hash ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat ppk (hash (exp (gen) (mul y x-0)) cr sr)))
      (send (cat ppk (hash (exp (gen) (mul y x-0)) cr sr))))
    ((recv (cat (exp (gen) (mul y x-0)) cr sr))
      (send (cat (exp (gen) (mul y x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 288)
  (parent 282)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 289)
  (parent 283)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (y rndx) (x expt) (y-0 x-0 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-0))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))
    (any any) (p p) (cr cr-0) (sr sr-0) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-0) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-0)) cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (6 0)) ((1 7) (0 4))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (1 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((1 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul y-0 x-0)) (5 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((send cr-0)
      (recv
        (cat sr-0 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x)) "client finished"
              (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x)
                  (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x)) "server finished"
            (hash cr-0 sr-0 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x)
                (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x)) "client finished"
                  (hash cr-0 sr-0
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x)
                      (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x)) cr-0 sr-0)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y x)) cr-0 sr-0) "server_write")))
      (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-0)
          (enc (hash cr sr (exp (gen) x-0)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-0)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-0)
                  (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-0)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-0)
                (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-0)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr sr (exp (gen) x-0)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-0)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-0)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-0)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-0)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-0)) cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 290)
  (parent 283)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) y-0) x-1))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-1))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) y-0) x-1)) (send (cat (exp (gen) y-0) x-1))))
  (label 291)
  (parent 286)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton ca
  (vars (any mesg) (cookie data) (response httpdata) (request httpreq)
    (p p-0 password) (cr sr cr-0 sr-0 cr-1 sr-1 random32) (ppk skey)
    (spk spk-0 akey) (u ca u-0 s ca-0 name) (pt pt-0 pval)
    (cookiestor locn) (x y rndx) (x-0 expt) (y-0 x-1 rndx))
  (defstrand clientr 7
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (response response) (request request) (cr cr) (sr sr) (spk spk-0)
    (u u) (s s) (ca ca-0) (cookiestor cookiestor) (y y-0) (x x-1))
  (defstrand serverr 2 (cr cr-0) (sr sr-0) (spk spk-0) (s s) (ca ca-0)
    (x x))
  (defstrand clienta 8
    (cookie
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))
    (any any) (p p) (cr cr-1) (sr sr-1) (spk spk) (u u) (s s) (ca ca)
    (cookiestor cookiestor) (y y) (x x-0))
  (defstrand servera 6 (cookie cookie) (p p-0) (cr cr) (sr sr) (ppk ppk)
    (spk spk-0) (u u-0) (s s) (ca ca-0) (x x-1) (y y-0))
  (deflistener
    (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener
    (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
  (deflistener (cat (exp (gen) (mul y-0 x-1)) cr sr))
  (deflistener (cat (exp (gen) x-1) y-0))
  (precedes ((0 0) (3 0)) ((0 2) (3 2)) ((0 2) (7 0)) ((1 1) (0 1))
    ((2 7) (0 4)) ((3 1) (0 1)) ((3 3) (0 3)) ((3 5) (2 5))
    ((4 1) (3 4)) ((5 1) (4 0)) ((6 1) (5 0)) ((7 1) (6 0)))
  (non-orig ppk (invk spk-0) (privk ca-0))
  (uniq-orig cookie cr sr)
  (uniq-gen x y y-0 x-1)
  (absent (y x-0))
  (gen-st
    (cat "client store" u s
      (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
  (facts (neq u-0 s))
  (leads-to ((2 7) (0 4)))
  (rule fact-servera-neq0 trRl_clienta-at-6 trRl_clienta-at-7)
  (operation nonce-test (added-listener (cat (exp (gen) x-1) y-0))
    (exp (gen) (mul y-0 x-1)) (6 0))
  (traces
    ((send cr)
      (recv
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (send
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (load cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))))
      (send
        (enc
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          request
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (recv
        (enc response
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv cr-0)
      (send
        (cat sr-0 (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x)
          (enc (hash cr-0 sr-0 (exp (gen) x)) (invk spk-0)))))
    ((send cr-1)
      (recv
        (cat sr-1 (cat s spk (enc (hash s spk) (privk ca)))
          (exp (gen) x-0)
          (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk))))
      (send
        (cat (exp (gen) y)
          (enc
            (hash (exp (gen) (mul y x-0)) "client finished"
              (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
                (cat (exp (gen) x-0)
                  (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                (exp (gen) y)))
            (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
              "client_write"))))
      (recv
        (enc
          (hash (exp (gen) (mul y x-0)) "server finished"
            (hash cr-1 sr-1 (cat s spk (enc (hash s spk) (privk ca)))
              (cat (exp (gen) x-0)
                (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
              (exp (gen) y)
              (enc
                (hash (exp (gen) (mul y x-0)) "client finished"
                  (hash cr-1 sr-1
                    (cat s spk (enc (hash s spk) (privk ca)))
                    (cat (exp (gen) x-0)
                      (enc (hash cr-1 sr-1 (exp (gen) x-0)) (invk spk)))
                    (exp (gen) y)))
                (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write")))
      (send
        (enc "login" u p
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "client_write")))
      (recv
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y x-0)) cr-1 sr-1)
            "server_write"))) (load cookiestor (cat pt-0 any))
      (stor cookiestor
        (cat pt "client store" u s
          (enc cookie
            (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr))))))
    ((recv cr)
      (send
        (cat sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
          (exp (gen) x-1)
          (enc (hash cr sr (exp (gen) x-1)) (invk spk-0))))
      (recv
        (cat (exp (gen) y-0)
          (enc
            (hash (exp (gen) (mul y-0 x-1)) "client finished"
              (hash cr sr
                (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                (cat (exp (gen) x-1)
                  (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                (exp (gen) y-0)))
            (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
              "client_write"))))
      (send
        (enc
          (hash (exp (gen) (mul y-0 x-1)) "server finished"
            (hash cr sr (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
              (cat (exp (gen) x-1)
                (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
              (exp (gen) y-0)
              (enc
                (hash (exp (gen) (mul y-0 x-1)) "client finished"
                  (hash cr sr
                    (cat s spk-0 (enc (hash s spk-0) (privk ca-0)))
                    (cat (exp (gen) x-1)
                      (enc (hash cr sr (exp (gen) x-1)) (invk spk-0)))
                    (exp (gen) y-0)))
                (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
                  "client_write"))))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "server_write")))
      (recv
        (enc "login" u-0 p-0
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
      (send
        (enc "login-successful"
          (enc cookie (hash ppk (hash (exp (gen) (mul y-0 x-1)) cr sr)))
          (hash (hash (exp (gen) (mul y-0 x-1)) cr sr)
            "server_write"))))
    ((recv (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (hash (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write"))
      (send
        (cat (hash (exp (gen) (mul y-0 x-1)) cr sr) "client_write")))
    ((recv (cat (exp (gen) (mul y-0 x-1)) cr sr))
      (send (cat (exp (gen) (mul y-0 x-1)) cr sr)))
    ((recv (cat (exp (gen) x-1) y-0)) (send (cat (exp (gen) x-1) y-0))))
  (label 292)
  (parent 286)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")
